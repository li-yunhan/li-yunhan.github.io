<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-test" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/test.html" class="article-date">
  <time class="dt-published" datetime="2021-10-09T09:15:52.808Z" itemprop="datePublished">2021-10-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/post/test.html">test</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/test.html" data-id="ckujl25fb00009u3n5ik7cctb" data-title="test" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1.Personal/笔记系统搭建" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/1.Personal/%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA.html" class="article-date">
  <time class="dt-published" datetime="2021-10-09T08:47:06.212Z" itemprop="datePublished">2021-10-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><h1 id="一-现状分析"><a href="#一-现状分析" class="headerlink" title="一 现状分析"></a>一 现状分析</h1><ol>
<li>Notion：外国软件，支持Web，Window，Mac。很好用，但是图床是存在他自己的服务器上，迁移比较麻烦。</li>
<li>语雀：阿里出品，支持Web，Window，Mac，思维导图等内容，也挺好用的。</li>
<li>OneNote：微软出品，没有那没好用</li>
<li>WizNote：国内软件，付费，无功无过</li>
<li>幕布：国内软件，付费，制作思维导图不错，处理不了复杂文本</li>
</ol>
<h3 id="github-page"><a href="#github-page" class="headerlink" title="github page"></a>github page</h3><h2 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h2><p><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">官方文档</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ol>
<li><p>准备内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt-get install npm</span><br><span class="line">sudo apt-get install git </span><br></pre></td></tr></table></figure></li>
<li><p>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> ~/hexo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install hexo-cli -g</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo init blog</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> blog</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo g <span class="comment"># 或者hexo generate</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo s <span class="comment"># 或者hexo server，可以在http://localhost:4000/ 查看</span></span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo n == hexo new</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo g == hexo generate</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo s == hexo server</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo d == hexo deploy</span></span><br></pre></td></tr></table></figure>

<h3 id="部署Hexo到Github-Pages"><a href="#部署Hexo到Github-Pages" class="headerlink" title="部署Hexo到Github Pages"></a>部署Hexo到Github Pages</h3><p>部署到github，在_config.yml中最后一行修改：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:username/username.github.io.git  # 修改修改</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p>其他平台参考<a target="_blank" rel="noopener" href="https://hexo.io/docs/deployment.html">deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/1.Personal/%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA.html" data-id="ckujlxfmj0000p53n9iw54l9i" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/hello-world.html" class="article-date">
  <time class="dt-published" datetime="2021-10-09T08:35:57.113Z" itemprop="datePublished">2021-10-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/post/hello-world.html">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/hello-world.html" data-id="ckujjnnqi0000ga3ndula9pze" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-5.Java/Mybatis" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/5.Java/Mybatis.html" class="article-date">
  <time class="dt-published" datetime="2021-10-08T08:58:00.289Z" itemprop="datePublished">2021-10-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/post/5.Java/Mybatis.html">Mybatis</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="一-概述"><a href="#一-概述" class="headerlink" title="一 概述"></a>一 概述</h1><h2 id="1-1-JDBC连接"><a href="#1-1-JDBC连接" class="headerlink" title="1.1 JDBC连接"></a>1.1 JDBC连接</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DriverManager</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Evan
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCTest</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> prepareStatement <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 加载驱动</span>
            <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 获取连接</span>
            <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://127.0.0.1:3306/ssmdemo"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>
            connection <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 获取statement，preparedStatement</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select * from tb_user where id=?"</span><span class="token punctuation">;</span>
            prepareStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 设置参数</span>
            prepareStatement<span class="token punctuation">.</span><span class="token function">setLong</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1l</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 执行查询</span>
            rs <span class="token operator">=</span> prepareStatement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 处理结果集</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"userName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 关闭连接，释放资源</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>prepareStatement <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                prepareStatement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="1-2-mybaits"><a href="#1-2-mybaits" class="headerlink" title="1.2 mybaits"></a>1.2 mybaits</h2><p>mybatis是优秀的基于java持久层的框架（半自动），它内部封装了jdbc，sql与java编码分离（sql单独提取到配置文件中，由开发者控制），开发者只需要关注sql语句本身（剩下的预编译、设置参数、执行sql、封装结果由框架完成）。它使用了ORM的思想实现了结果集的封装。</p>
<h1 id="二-HelloWorld"><a href="#二-HelloWorld" class="headerlink" title="二 HelloWorld"></a>二 HelloWorld</h1><h2 id="2-1-创建mybatis核心配置文件"><a href="#2-1-创建mybatis核心配置文件" class="headerlink" title="2.1 创建mybatis核心配置文件"></a>2.1 创建mybatis核心配置文件</h2><p>可以通过properties标签引入外部properties文件</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">driver=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/mybatis?userSSL=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>useUnicode=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>characterEncoding=UTF-8
username=root
password=1234
<span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">configuration</span>
        <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Config 3.0//EN"</span>
        <span class="token string">"&lt;http://mybatis.org/dtd/mybatis-3-config.dtd>"</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- configuration: 核心配置文件 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!-- 
		properties: 引入外部properties文件 必须放在最前面,否则会报错
			resource: 类路径下
			url: 磁盘路径或网络路径
 	--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbc.properties<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    
    <span class="token comment">&lt;!-- 设置日志输出, 方便观察sql语句和参数 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logImpl<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>LOG4J<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!--
        environments配置项目的运行环境, 可以配置多个
        default: 启用的环境
     --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>development<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>development<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>JDBC<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POOLED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token comment">&lt;!-- 数据库连接信息 --></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;driver&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;url&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;username&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;password&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!-- 每一个Mapper.xml都需要在MyBatis核心配置文件中注册!!! --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org/hong/mapper/UserMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-2-创建实体类"><a href="#2-2-创建实体类" class="headerlink" title="2.2 创建实体类"></a>2.2 创建实体类</h2><p>就是在entity层或者pojo层创建数据库对应的实体类</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>hong<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> pwd<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-3-创建接口"><a href="#2-3-创建接口" class="headerlink" title="2.3 创建接口"></a>2.3 创建接口</h2><p>在mapper文件中创建一个接口(UserMapper.java)</p>
<p>相当于dto层，在这个类中定义抽象方法</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>hong<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>hong<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-4-创建mapper-xml"><a href="#2-4-创建mapper-xml" class="headerlink" title="2.4 创建mapper.xml"></a>2.4 创建mapper.xml</h2><p>将EmployeeMapper.xml中的namespace改为接口的全类名，将标签中的”id”改为与接口中定义的抽象方法相同的方法名</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span>
        <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>
        <span class="token string">"&lt;http://mybatis.org/dtd/mybatis-3-mapper.dtd>"</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--
    namespace:名称空间, 对应接口的全类名
 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.hong.mapper.UserMapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!--
        select: 配置查询
        id: 唯一标识, 对应接口中的方法名
        resultType: 返回值类型, 类的全类名, 如果返回值是集合写集合中泛型的类型
     --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getAll<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.hong.pojo.User<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        select * from user
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-5-测试"><a href="#2-5-测试" class="headerlink" title="2.5 测试"></a>2.5 测试</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>hong<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Resources</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSession</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>hong<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">UserMapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>hong<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloTest</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">getSqlSessionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// MyBatis全局配置文件路径</span>
        <span class="token class-name">String</span> resource <span class="token operator">=</span> <span class="token string">"mybatis-config.xml"</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取MyBatis全局配置文件的输入流</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取SqlSessionFactory对象</span>
        <span class="token class-name">SqlSessionFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> factory<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 1、获取SqlSessionFactory对象</span>
        <span class="token class-name">SqlSessionFactory</span> factory <span class="token operator">=</span> <span class="token function">getSqlSessionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2、获取SqlSession对象</span>
        <span class="token class-name">SqlSession</span> openSession <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 3、获取接口的实现类对象</span>
            <span class="token comment">// 会为接口自动创建代理对象, 代理对象去执行增删改查方法, sql语句会从mapper.xml中获取</span>
            <span class="token class-name">UserMapper</span> mapper <span class="token operator">=</span> openSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">UserMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// 4、SqlSession代表和数据库的一次对话, 用完必须关闭</span>
            openSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p>整个mybatis一共有两个重要的配置文件</p>
<ol>
<li>mybatis-config.xml</li>
<li>用户类Mapper.xml</li>
</ol>
<h1 id="三-核心配置文件"><a href="#三-核心配置文件" class="headerlink" title="三 核心配置文件"></a>三 核心配置文件</h1><p>标签说明</p>
<h2 id="3-1-properties"><a href="#3-1-properties" class="headerlink" title="3.1 properties"></a>3.1 properties</h2><p>mybatis可以使用properties标签来引入外部properties配置文件的内容。</p>
<p>比如上边提到的demo</p>
<h2 id="3-2-settings"><a href="#3-2-settings" class="headerlink" title="3.2 settings"></a>3.2 settings</h2><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 开启驼峰命名 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mapUnderscoreToCamelCase<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="3-3-environments"><a href="#3-3-environments" class="headerlink" title="3.3 environments"></a>3.3 environments</h2><p>MyBatis 可以配置成适应多种环境</p>
<p><strong>尽管可以配置多个环境，但每个 SqlSessionFactory 实例只能选择一种环境。</strong></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- default: 表示使用哪种环境 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- MySql环境 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>JDBC<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POOLED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.mysql.jdbc.Driver<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbc:mysql://localhost:3306/mybatis?userSSL=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>useUnicode=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>characterEncoding=UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1234<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- Oracle环境 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>oracle环境<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>JDBC<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POOLED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Driver: com.ibm.db2.jdbc.app.DB2Driver<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbc:db2://localhost:5000/orcl<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scott<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ccat<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-4-typeAliases"><a href="#3-4-typeAliases" class="headerlink" title="3.4 typeAliases"></a>3.4 typeAliases</h2><p>类型别名可为 Java 类型设置一个缩写名字。存在的意义仅在于用来<strong>降低冗余的全限定类名书写，MyBatis中的别名是不区分大小写的</strong></p>
<p>有三种方法</p>
<ol>
<li><p>给实体类起别名</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- 可以给实体类起别名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAlias</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pojo.User<span class="token punctuation">"</span></span> <span class="token attr-name">alias</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>User<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>指定包名</p>
<p>也可以指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean每一个在包 <code>org.hong.pojo</code> 中的 Java Bean，在<strong>没有注解</strong>的情况下，会使用 <strong>Bean 的首字母小写的非限定类名来作为它的别名</strong>，比如 <code>org.hong.pojo.User</code> 的别名为 <code>user</code></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.hong.pojo<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
<li><p>使用注解</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Alias</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Author</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="3-5-Mapper"><a href="#3-5-Mapper" class="headerlink" title="3.5 Mapper"></a>3.5 Mapper</h2><ol>
<li><p>使用相对于类路径的资源引用</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- 使用相对于类路径的资源引用 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org/hong/mapper/UserMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>使用映射器接口实现类的完全限定类名</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- 使用映射器接口实现类的完全限定类名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.hong.mapper.UserMapper<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>将包内的映射器接口实现全部注册为映射器</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- 将包内的映射器接口实现全部注册为映射器 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.hong.mapper<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p>方式二&amp;方式三的<strong>注意点</strong>：</p>
<ol>
<li><p>接口和对应的Mapper配置文件<strong>必须同名</strong></p>
</li>
<li><p>接口和对应的Mapper配置文件</p>
<p>编译后必须在同一个文件夹下</p>
<ol>
<li>可以把接口和对应的Mapper<strong>创建在同一个包下</strong></li>
<li>可以在<strong>resources文件加中创建和接口相同层数并且名称相同的包，然后创建接口对应的Mapper</strong></li>
<li>也可以使用spring-boot指定文件</li>
</ol>
</li>
</ol>
<h1 id="四-映射文件Mapper-xml"><a href="#四-映射文件Mapper-xml" class="headerlink" title="四 映射文件Mapper.xml"></a>四 映射文件Mapper.xml</h1><p>文件样式</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="token string">"&lt;http://mybatis.org/dtd/mybatis-3-mapper.dtd>"</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.frog.dao.ShopDao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Mybatis支持增删改返回Integer、Long、Boolean类型返回值，在接口中直接在方法上中定义即可，Mybatis会自动封装</p>
<h2 id="4-1-CRUD标签"><a href="#4-1-CRUD标签" class="headerlink" title="4.1 CRUD标签"></a>4.1 CRUD标签</h2><h3 id="4-1-1-select"><a href="#4-1-1-select" class="headerlink" title="4.1.1 select"></a>4.1.1 select</h3><p>select – 书写查询sql语句</p>
<p>select中的几个属性说明：</p>
<p>id属性：当前名称空间下的statement的唯一标识。<strong>要求</strong>id和mapper接口中的方法的名字一致。</p>
<p>resultType：将结果集映射为java的对象类型。必须（和 resultMap 二选一）</p>
<p>parameterType：传入参数类型。可以省略</p>
<h3 id="4-1-2-insert"><a href="#4-1-2-insert" class="headerlink" title="4**.1.2.insert**"></a>4**.1.2.insert**</h3><p>insert 的几个属性说明：</p>
<p>id：唯一标识，随便写，在同一个命名空间下保持唯一，使用动态代理之后要求和方法名保持一致parameterType：参数的类型，使用动态代理之后和方法的参数类型一致</p>
<p>useGeneratedKeys: 开启主键回写</p>
<p>keyColumn：指定数据库的主键</p>
<p>keyProperty：主键对应的pojo属性名</p>
<p>标签内部：具体的sql语句。</p>
<h3 id="4-1-3-update"><a href="#4-1-3-update" class="headerlink" title="4**.1.3.update**"></a>4**.1.3.update**</h3><p>id属性：当前名称空间下的statement的唯一标识(必须属性)；</p>
<p>parameterType：传入的参数类型，可以省略。</p>
<p>标签内部：具体的sql语句。</p>
<h3 id="4-1-4-delete"><a href="#4-1-4-delete" class="headerlink" title="4**.1.4.delete**"></a>4**.1.4.delete**</h3><p>delete 的几个属性说明：</p>
<p>id属性：当前名称空间下的statement的唯一标识(必须属性)；</p>
<p>parameterType：传入的参数类型，可以省略。</p>
<p>标签内部：具体的sql语句。</p>
<h1 id="五-动态sql"><a href="#五-动态sql" class="headerlink" title="五 动态sql"></a>五 动态sql</h1><h2 id="5-1-常用标签"><a href="#5-1-常用标签" class="headerlink" title="5.1 常用标签"></a>5.1 常用标签</h2><h3 id="5-1-1-if"><a href="#5-1-1-if" class="headerlink" title="5.1.1 if"></a>5.1.1 if</h3><h1 id="逆向工程"><a href="#逆向工程" class="headerlink" title="逆向工程"></a>逆向工程</h1><p>MyBatis generator</p>
<p>MyBatis generator用数据库表生成代码的时候，除了生成pojo以外，同时会生成Example文件，以及在mapper.xml文件中生成相应的sql语句。</p>
<p>Example类中包含一个静态类Criteria，利用Criteria我们可以在类中根据自己的需求动态生成sql where字句，不用在进行修改mapper文件，或者添加sql语句了。</p>
<p>依赖</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">&lt;</span>dependency<span class="token operator">></span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">></span>org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>generator<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>mybatis<span class="token operator">-</span>generator<span class="token operator">-</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>
    <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">1.3</span><span class="token number">.5</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>几种常用的方法：</p>
<ol>
<li><p>模糊查询</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> name <span class="token operator">=</span><span class="token string">"成"</span>；
<span class="token class-name">UsernameExample</span> ex<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">UsernameExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ex<span class="token punctuation">.</span>createCriteria<span class="token punctuation">.</span><span class="token function">andNameLike</span><span class="token punctuation">(</span><span class="token string">'%'</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span> userList<span class="token operator">=</span>userMapper<span class="token punctuation">.</span><span class="token function">selectByExamle</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>通过某个字段排序</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> orderByClause<span class="token operator">=</span><span class="token string">"id DESC"</span>；
<span class="token class-name">UsernameExample</span> ex<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">UsernameExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ex<span class="token punctuation">.</span><span class="token function">setOrderByClause</span><span class="token punctuation">(</span>orderByClause<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span> userList<span class="token operator">=</span>userMapper<span class="token punctuation">.</span><span class="token function">selectByExamle</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>条件搜索，不确定条件个数</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">UserDaoExample</span> ex<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">UserExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Criteria</span> criteria<span class="token operator">=</span>ex<span class="token punctuation">.</span><span class="token function">createCriterria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  criteria<span class="token punctuation">.</span><span class="token function">andnameEqualTo</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 criteria<span class="token punctuation">.</span><span class="token function">andNameEqualTo</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList<span class="token operator">=</span>userMapper<span class="token punctuation">.</span><span class="token function">selectByExample</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p>Example This example tells MyBatis to ignore every column in the Foo table that begins with the characters “col” (case-insensitive) except for “col01” and “col13”.</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">tableName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Foo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ignoreColumnsByRegex</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(?i)col.*<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>except</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col01<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>except</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col13<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ignoreColumnsByRegex</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>其中example中</p>
<ul>
<li><strong>Criterion</strong> Criterion是最基本,最底层的Where条件，用于字段级的筛选，feild用于指代字段名字,列举如下: 只有一个条件,不需要其他参考值 feild IS NOLL feild IS NOT NULL 与一个参考值进行算数运算 feild &gt; value feild &gt;= value feild = value feild &lt;&gt; value feild &lt;= value feild &lt; value 与一个参考值进行模糊查询,参值中的%,?只能在构造查询条件时手动指定。 feild LIKE value feild NOT LIKE value 介于两个参考值之间 feild BETWEEN value AND secondValue 在或不在一个参考值集合中,item来自于value集合 feild IN (item,item,item,…) feild NOT IN (item,item,item,…) MyBatis Generator会为每个字段产生如上的Criterion，如果表的字段比较多,产生的Example类会十分庞大。理论上通过Example类可以构造你想到的任何筛选条件。</li>
<li><strong>Criteria</strong> Criteria包含一个Cretiron的集合,每一个Criteria对象内包含的Cretiron之间是由AND连接的,是逻辑与的关系。</li>
<li><strong>oredCriteria</strong> Example内有一个成员叫oredCriteria,是Criteria的集合,就想其名字所预示的一样，这个集合中的Criteria是由OR连接的，是逻辑或关系。oredCriteria就是ORed Criteria。</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">TestTableExample</span> example <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestTableExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  example<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">andField1EqualTo</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">andField2IsNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  example<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">andField3NotEqualTo</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">andField4IsNotNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> field5Values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  field5Values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  field5Values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  field5Values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  field5Values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  example<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">andField5In</span><span class="token punctuation">(</span>field5Values<span class="token punctuation">)</span><span class="token punctuation">;</span>

  example<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">andField6Between</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>or()方法会产生一个新的Criteria对象,添加到oredCriteria中,并返回这个Criteria对象，从而可以链式表达，为其添加Criterion。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">where</span> <span class="token punctuation">(</span>field1 <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">and</span> field2 <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
     <span class="token operator">or</span> <span class="token punctuation">(</span>field3 <span class="token operator">&lt;></span> <span class="token number">9</span> <span class="token operator">and</span> field4 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
     <span class="token operator">or</span> <span class="token punctuation">(</span>field5 <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token operator">or</span> <span class="token punctuation">(</span>field6 <span class="token operator">between</span> <span class="token number">3</span> <span class="token operator">and</span> <span class="token number">7</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>实现 a=x and (b=xx or b=xxx)这样的查询条件</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">AccountExample</span> accountExample <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AccountExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">AccountExample<span class="token punctuation">.</span>Criteria</span> criteria <span class="token operator">=</span> accountExample<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">andTypeEqualTo</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">addCriterion</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">" (ID=%d or ID=%d) "</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">></span></span> accounts <span class="token operator">=</span> accountMapper<span class="token punctuation">.</span><span class="token function">selectByExample</span><span class="token punctuation">(</span>accountExample<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> accounts<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Mapper文件中方法</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>int countByExample(UserExample example)</td>
<td>按条件计数</td>
</tr>
<tr>
<td>int deleteByPrimaryKey(Integer id)</td>
<td>按主键删除</td>
</tr>
<tr>
<td>int deleteByExample(UserExample example)</td>
<td>按条件删除</td>
</tr>
<tr>
<td>String/Integer insert(User record)</td>
<td>插入数据，返回值的ID</td>
</tr>
<tr>
<td>String/Integer insertSelective(User record)</td>
<td>插入一条数据,只插入不为null的字段</td>
</tr>
<tr>
<td>User selectByPrimaryKey(Integer id)</td>
<td>按主键查询</td>
</tr>
<tr>
<td>List selectByExampleWithBLOGs(UserExample example)</td>
<td>按条件查询（包括BLOB字段）。text类型会走</td>
</tr>
<tr>
<td>int updateByPrimaryKey(User record)</td>
<td>按主键更新</td>
</tr>
<tr>
<td>int updateByPrimaryKeySelective(User record)</td>
<td>按主键更新值不为null的字段</td>
</tr>
<tr>
<td>int updateByExample(User record, UserExample example)</td>
<td>按条件更新</td>
</tr>
<tr>
<td>int updateByExampleSelective(User record, UserExample example)</td>
<td>按条件更新值不为null的字段</td>
</tr>
</tbody></table>
<p>Xxx表示的是字段</p>
<p>Example常用方法</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>example.setOrderByClause(“字段名 ASC”);</td>
<td>添加升序排列条件，DESC为降序</td>
</tr>
<tr>
<td>example.setDistinct(false)</td>
<td>去除重复，boolean型，true为选择不重复的记录。</td>
</tr>
<tr>
<td>criteria.andXxxIsNull</td>
<td>添加字段xxx为null的条件</td>
</tr>
<tr>
<td>criteria.andXxxIsNotNull</td>
<td>添加字段xxx不为null的条件</td>
</tr>
<tr>
<td>criteria.andXxxNotEqualTo(value)</td>
<td>添加xxx字段不等于value条件</td>
</tr>
<tr>
<td>criteria.andXxxGreaterThan(value)</td>
<td>添加xxx字段大于value条件</td>
</tr>
<tr>
<td>criteria.andXxxGreaterThanOrEqualTo(value)</td>
<td>添加xxx字段大于等于value条件</td>
</tr>
<tr>
<td>criteria.andXxxLessThan(value)</td>
<td>添加xxx字段小于value条件</td>
</tr>
<tr>
<td>criteria.andXxxLessThanOrEqualTo(value)</td>
<td>添加xxx字段小于等于value条件</td>
</tr>
<tr>
<td>criteria.andXxxIn(List&lt;？&gt;)</td>
<td>添加xxx字段值在List&lt;？&gt;条件</td>
</tr>
<tr>
<td>criteria.andXxxNotIn(List&lt;？&gt;)</td>
<td>添加xxx字段值不在List&lt;？&gt;条件</td>
</tr>
<tr>
<td>criteria.andXxxLike(“%”+value+”%”)</td>
<td>添加xxx字段值为value的模糊查询条件</td>
</tr>
<tr>
<td>criteria.andXxxNotLike(“%”+value+”%”)</td>
<td>添加xxx字段值不为value的模糊查询条件</td>
</tr>
<tr>
<td>criteria.andXxxBetween(value1,value2)</td>
<td>添加xxx字段值在value1和value2之间条件</td>
</tr>
<tr>
<td>criteria.andXxxNotBetween(value1,value2)</td>
<td>添加xxx字段值不在value1和value2之间条件</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/5.Java/Mybatis.html" data-id="ckujnxa6b0000hr3n3pwj94fg" data-title="Mybatis" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-10.Body/运动解剖学" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/10.Body/%E8%BF%90%E5%8A%A8%E8%A7%A3%E5%89%96%E5%AD%A6.html" class="article-date">
  <time class="dt-published" datetime="2021-10-06T23:58:50.868Z" itemprop="datePublished">2021-10-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/post/10.Body/%E8%BF%90%E5%8A%A8%E8%A7%A3%E5%89%96%E5%AD%A6.html">运动解剖学</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[toc]</p>
<h1 id="一-概论"><a href="#一-概论" class="headerlink" title="一 概论"></a>一 概论</h1><h2 id="1-1-解剖学姿势"><a href="#1-1-解剖学姿势" class="headerlink" title="1.1 解剖学姿势"></a>1.1 解剖学姿势</h2><h2 id="1-2-人体运动面"><a href="#1-2-人体运动面" class="headerlink" title="1.2 人体运动面"></a>1.2 人体运动面</h2><h2 id="1-3-骨骼"><a href="#1-3-骨骼" class="headerlink" title="1.3 骨骼"></a>1.3 骨骼</h2><h2 id="1-4-关节"><a href="#1-4-关节" class="headerlink" title="1.4 关节"></a>1.4 关节</h2><h2 id="1-5-肌肉"><a href="#1-5-肌肉" class="headerlink" title="1.5 肌肉"></a>1.5 肌肉</h2><h2 id="1-6-肌肉收缩形式"><a href="#1-6-肌肉收缩形式" class="headerlink" title="1.6 肌肉收缩形式"></a>1.6 肌肉收缩形式</h2><h1 id="二-躯干"><a href="#二-躯干" class="headerlink" title="二 躯干"></a>二 躯干</h1><h2 id="2-1-人体体态学"><a href="#2-1-人体体态学" class="headerlink" title="2.1 人体体态学"></a>2.1 人体体态学</h2><h2 id="2-2-躯干的整体运动"><a href="#2-2-躯干的整体运动" class="headerlink" title="2.2 躯干的整体运动"></a>2.2 躯干的整体运动</h2><h2 id="2-3-运动中的椎骨"><a href="#2-3-运动中的椎骨" class="headerlink" title="2.3 运动中的椎骨"></a>2.3 运动中的椎骨</h2><h2 id="2-4-盆骨"><a href="#2-4-盆骨" class="headerlink" title="2.4 盆骨"></a>2.4 盆骨</h2><h2 id="2-5-骶骨"><a href="#2-5-骶骨" class="headerlink" title="2.5 骶骨"></a>2.5 骶骨</h2><h2 id="2-6-脊柱腰段"><a href="#2-6-脊柱腰段" class="headerlink" title="2.6 脊柱腰段"></a>2.6 脊柱腰段</h2><h2 id="2-7-脊柱胸段"><a href="#2-7-脊柱胸段" class="headerlink" title="2.7 脊柱胸段"></a>2.7 脊柱胸段</h2><h2 id="2-8-脊柱颈段"><a href="#2-8-脊柱颈段" class="headerlink" title="2.8 脊柱颈段"></a>2.8 脊柱颈段</h2><h2 id="2-9-躯干与颈后部的肌肉"><a href="#2-9-躯干与颈后部的肌肉" class="headerlink" title="2.9 躯干与颈后部的肌肉"></a>2.9 躯干与颈后部的肌肉</h2><h2 id="2-10-颈前面及侧面的肌肉"><a href="#2-10-颈前面及侧面的肌肉" class="headerlink" title="2.10 颈前面及侧面的肌肉"></a>2.10 颈前面及侧面的肌肉</h2><h2 id="2-11-胸肌"><a href="#2-11-胸肌" class="headerlink" title="2.11 胸肌"></a>2.11 胸肌</h2><h1 id="三-肩部"><a href="#三-肩部" class="headerlink" title="三 肩部"></a>三 肩部</h1><h1 id="四-肘"><a href="#四-肘" class="headerlink" title="四 肘"></a>四 肘</h1><h1 id="五-手腕与手掌"><a href="#五-手腕与手掌" class="headerlink" title="五 手腕与手掌"></a>五 手腕与手掌</h1><h1 id="六-髋与膝"><a href="#六-髋与膝" class="headerlink" title="六 髋与膝"></a>六 髋与膝</h1><h1 id="七-踝与足"><a href="#七-踝与足" class="headerlink" title="七 踝与足"></a>七 踝与足</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/10.Body/%E8%BF%90%E5%8A%A8%E8%A7%A3%E5%89%96%E5%AD%A6.html" data-id="ckujn7ln50001a53n0og0790b" data-title="运动解剖学" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-3.BigData/hive" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/3.BigData/hive.html" class="article-date">
  <time class="dt-published" datetime="2021-10-05T23:44:14.290Z" itemprop="datePublished">2021-10-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/post/3.BigData/hive.html">Hive</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="第一章-Hive基本概念"><a href="#第一章-Hive基本概念" class="headerlink" title="第一章 Hive基本概念"></a>第一章 Hive基本概念</h1><h2 id="1-1-定义"><a href="#1-1-定义" class="headerlink" title="1.1 定义"></a>1.1 定义</h2><p>一个数据仓库，解决海量结构化日志的数据统计，本质是将HQL转化成MapReduce程序。</p>
<h1 id="第三章-Hive数据类型"><a href="#第三章-Hive数据类型" class="headerlink" title="第三章 Hive数据类型"></a>第三章 Hive数据类型</h1><h2 id="3-1-基本数据类型"><a href="#3-1-基本数据类型" class="headerlink" title="3.1 基本数据类型"></a>3.1 基本数据类型</h2><ol>
<li><p><strong>INT（常用）</strong></p>
</li>
<li><p>BIGINT</p>
</li>
<li><p>DOUBLE</p>
</li>
<li><p>decimal(10, 4) 准确精度类型</p>
</li>
<li><p><strong>STRING（常用）</strong></p>
</li>
<li><p>集合数据类型</p>
<ul>
<li><p>STRUCT（和C的struct类似）</p>
</li>
<li><p>MAP</p>
</li>
<li><p>array</p>
<p><strong>赋值</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> array<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> a
<span class="token punctuation">)</span> <span class="token keyword">as</span> t<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>常用方法</strong></p>
<ol>
<li>array_contains(array, field)</li>
<li>sort_array</li>
</ol>
</li>
</ul>
</li>
</ol>
<ul>
<li>类型转换<ul>
<li>小类型的可以转成大类型的</li>
<li>也可以通过CAST强转</li>
</ul>
</li>
</ul>
<h1 id="第四章-DDL数据定义"><a href="#第四章-DDL数据定义" class="headerlink" title="第四章 DDL数据定义"></a>第四章 DDL数据定义</h1><h2 id="4-1-创建数据库"><a href="#4-1-创建数据库" class="headerlink" title="4.1 创建数据库"></a>4.1 创建数据库</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">create database <span class="token keyword">if</span> not exists db_hive location <span class="token string">'/db_hive.db'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="4-2-查询数据库"><a href="#4-2-查询数据库" class="headerlink" title="4.2 查询数据库"></a>4.2 查询数据库</h2><h3 id="4-2-1-显示数据库"><a href="#4-2-1-显示数据库" class="headerlink" title="4.2.1 显示数据库"></a>4.2.1 显示数据库</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">show database<span class="token punctuation">;</span>
<span class="token comment"># 过滤显示查询的数据库</span>
show database like <span class="token string">'db_hive'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="4-2-2-查看数据库详情"><a href="#4-2-2-查看数据库详情" class="headerlink" title="4.2.2 查看数据库详情"></a>4.2.2 查看数据库详情</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">desc database db_hive<span class="token punctuation">;</span>
<span class="token comment"># 显示数据库详细信息</span>
desc database extended db_hive<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="4-2-3-切换当前数据库"><a href="#4-2-3-切换当前数据库" class="headerlink" title="4.2.3 切换当前数据库"></a>4.2.3 切换当前数据库</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use db_hive<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="4-3-修改数据库"><a href="#4-3-修改数据库" class="headerlink" title="4.3 修改数据库"></a>4.3 修改数据库</h2><p>只是增加了这个数据库的属性信息，无法更改元数据，通过键值对的方式进行赋值</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">alter database db_hive <span class="token builtin class-name">set</span> dbpropertites<span class="token punctuation">(</span><span class="token string">'createtime'</span><span class="token operator">=</span><span class="token string">'20170830'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="4-4-删除数据库"><a href="#4-4-删除数据库" class="headerlink" title="4.4 删除数据库"></a>4.4 删除数据库</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">drop database <span class="token keyword">if</span> exists db_hive cascade<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="4-5-创建表"><a href="#4-5-创建表" class="headerlink" title="4.5 创建表"></a>4.5 创建表</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">--复制bcd的结构到abc上</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> f_fuwu<span class="token punctuation">.</span>abc <span class="token operator">like</span> f_fuwu<span class="token punctuation">.</span>bcd<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">*</span><span class="token operator">*</span><span class="token keyword">CREATE</span> <span class="token punctuation">[</span>EXTERNAL<span class="token punctuation">]</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> table_name
<span class="token punctuation">[</span><span class="token punctuation">(</span>col_name data_type <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token punctuation">[</span><span class="token keyword">COMMENT</span> table_comment<span class="token punctuation">]</span> 
<span class="token punctuation">[</span>PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name data_type <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
<span class="token punctuation">[</span><span class="token keyword">CLUSTERED</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>SORTED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name <span class="token punctuation">[</span><span class="token keyword">ASC</span><span class="token operator">|</span><span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">INTO</span> num_buckets BUCKETS<span class="token punctuation">]</span> 
<span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token keyword">ROW</span> FORMAT row_format<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token punctuation">[</span>STORED <span class="token keyword">AS</span> file_format<span class="token punctuation">]</span> 
<span class="token punctuation">[</span>LOCATION hdfs_path<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>hive表数据是存储在HDFS上的，因此需要有文件存储格式来规范化数据的存储，以便hive写数据或者读数据。hive有一些已构建好的存储格式，也支持用户自定义文件存储格式。主要由两部分内容构成file_format和row_format,两者息息相关，在create table语句中结构如下：</p>
<blockquote>
<p>SerDe is a short name for “Serializer and Deserializer.”<br>Hive uses SerDe (and !FileFormat) to read and write table rows.<br>HDFS files –&gt; InputFileFormat –&gt; &lt;key, value&gt; –&gt; Deserializer –&gt; Row object<br>Row object –&gt; Serializer –&gt; &lt;key, value&gt; –&gt; OutputFileFormat –&gt; HDFS files<br>Note that the “key” part is ignored when reading, and is always a constant when writing. Basically row object is stored into the “value”.</p>
</blockquote>
<h3 id="4-5-1-管理表"><a href="#4-5-1-管理表" class="headerlink" title="4.5.1 管理表"></a>4.5.1 管理表</h3><p>默认创建的表的都是管理表，也叫内部表。这种表完全有hive来控制，删除了的话，元数据和源数据都会被删除。</p>
<h3 id="4-5-2-外部表"><a href="#4-5-2-外部表" class="headerlink" title="4.5.2 外部表"></a>4.5.2 外部表</h3><p>hive并不认为这个表完全属于自己，删除的时候只会删除元数据，原始的数据内容则会被保存。</p>
<h3 id="4-5-3-外部表和内部表的转换"><a href="#4-5-3-外部表和内部表的转换" class="headerlink" title="4.5.3 外部表和内部表的转换"></a>4.5.3 外部表和内部表的转换</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">alter table db_hive <span class="token builtin class-name">set</span> tblproperties<span class="token punctuation">(</span><span class="token string">'EXTERNAL'</span><span class="token operator">=</span><span class="token string">'FALSE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="4-5-4-创建外表"><a href="#4-5-4-创建外表" class="headerlink" title="4.5.4 创建外表"></a>4.5.4 创建外表</h3><p>要注意location的位置在哪里</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> EXTERNAL <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>tk_aurora_order_detail<span class="token punctuation">`</span><span class="token punctuation">(</span>
  <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">bigint</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>order_create_date<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>order_id<span class="token punctuation">`</span> <span class="token keyword">bigint</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>order_display_id<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>order_origin<span class="token punctuation">`</span> <span class="token keyword">bigint</span>
<span class="token punctuation">)</span>
<span class="token keyword">COMMENT</span> <span class="token string">''</span>
<span class="token keyword">ROW</span> FORMAT SERDE 
  <span class="token string">'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'</span> 
<span class="token keyword">WITH</span> SERDEPROPERTIES <span class="token punctuation">(</span> 
  <span class="token string">'field.delim'</span><span class="token operator">=</span><span class="token string">'\u0001'</span><span class="token punctuation">,</span> 
  <span class="token string">'line.delim'</span><span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">,</span> 
  <span class="token string">'serialization.format'</span><span class="token operator">=</span><span class="token string">'\u0001'</span><span class="token punctuation">)</span> 
STORED <span class="token keyword">AS</span> INPUTFORMAT 
  <span class="token string">'org.apache.hadoop.mapred.TextInputFormat'</span> 
OUTPUTFORMAT 
  <span class="token string">'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'</span>
LOCATION
  <span class="token string">'viewfs://qunarcluster/user/ticketdev/hive/warehouse/aurora.db/order_detail'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-5-5-临时表"><a href="#4-5-5-临时表" class="headerlink" title="4.5.5 临时表"></a>4.5.5 临时表</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">WITH</span> t1 <span class="token keyword">AS</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span>
        <span class="token keyword">FROM</span> carinfo
    <span class="token punctuation">)</span><span class="token punctuation">,</span> 
    t2 <span class="token keyword">AS</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span>
        <span class="token keyword">FROM</span> car_blacklist
    <span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> t1<span class="token punctuation">,</span> t2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-6-分区表"><a href="#4-6-分区表" class="headerlink" title="4.6 分区表"></a>4.6 分区表</h2><p>分区表实际上就是对应HDFS文件系统上独立的文件夹，该文件夹下是该分区所有的数据文件。Hive中的分区就是分目录。</p>
<p>就是把HDFS上的独立的文件变成一个文件夹，这样以后查数据的时候容易一些。</p>
<h3 id="4-6-1-分区表的基本操作"><a href="#4-6-1-分区表的基本操作" class="headerlink" title="4.6.1 分区表的基本操作"></a>4.6.1 分区表的基本操作</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1.创建分区表语法</span>
create table dept<span class="token punctuation">(</span>
		dept_no int, 
		dname string,
		loc string<span class="token punctuation">)</span>
partitioned by <span class="token punctuation">(</span>month string<span class="token punctuation">)</span>
row <span class="token function">format</span> delimited fields terminated by <span class="token string">'\t'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 2.加载数据到分区表中</span>
load data <span class="token builtin class-name">local</span> inpath <span class="token string">'opt/dept.txt'</span> into table dept partition<span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 3.查询分区表中数据</span>
<span class="token keyword">select</span> * from dept where month <span class="token operator">=</span> <span class="token string">'201709'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 4.增加分区</span>
<span class="token comment"># 创建单个分区</span>
alter table dept <span class="token function">add</span> partition（month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 创建多个分区</span>
alter table dept <span class="token function">add</span> partition（month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span>, partition（month<span class="token operator">=</span><span class="token string">'201708'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 5.删除分区</span>
<span class="token comment"># 删除单个分区</span>
alter table dept drop partition（month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 删除多个分区</span>
alter table dept drop partition（month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span>, partition（month<span class="token operator">=</span><span class="token string">'201708'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 6.查看分区表有多少分区</span>
show partitions dept<span class="token punctuation">;</span>
<span class="token comment"># 7. 查看分区表结构</span>
desc formatted dept<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-6-2-二级分区"><a href="#4-6-2-二级分区" class="headerlink" title="4.6.2 二级分区"></a>4.6.2 二级分区</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1.创建二级分区</span>
create table dept<span class="token punctuation">(</span>deptno int, dname string<span class="token punctuation">)</span>
partition by <span class="token punctuation">(</span>month string, day string<span class="token punctuation">)</span>
row <span class="token function">format</span> delimited fiedls terminated by <span class="token string">'\t'</span><span class="token punctuation">;</span>

<span class="token comment"># 2.正常加载数据</span>
<span class="token comment"># (1) 加载数据到二级分区表中</span>
load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/opt/dept.txt'</span> into table
dept partition<span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201709'</span>, <span class="token assign-left variable">day</span><span class="token operator">=</span><span class="token string">'13'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># (2) 查询分区数据</span>
<span class="token keyword">select</span> * from dept where <span class="token assign-left variable">month</span><span class="token operator">=</span><span class="token string">'201709'</span> and <span class="token assign-left variable">day</span><span class="token operator">=</span><span class="token string">'13'</span><span class="token punctuation">;</span>

<span class="token comment"># 数据直接上传到分区目录上，让分区表和数据产生关联有3种方式</span>
<span class="token comment"># 只说一种了 创建文件夹后load数据到分区</span>
dfs -mkdir -p /user/hive/warhouse/dept/month<span class="token operator">=</span><span class="token number">201709</span>/day<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">;</span>
load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/opt/dept.txt'</span> into table
dept partition<span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201709'</span>, <span class="token assign-left variable">day</span><span class="token operator">=</span><span class="token string">'13'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-7-修改表"><a href="#4-7-修改表" class="headerlink" title="4.7 修改表"></a>4.7 修改表</h2><h3 id="4-7-1-重命名表"><a href="#4-7-1-重命名表" class="headerlink" title="4.7.1 重命名表"></a>4.7.1 重命名表</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">alter table table_name <span class="token function">rename</span> to new_table_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="4-7-2-增加、修改和删除表分区"><a href="#4-7-2-增加、修改和删除表分区" class="headerlink" title="4.7.2 增加、修改和删除表分区"></a>4.7.2 增加、修改和删除表分区</h3><p>见4.6.1</p>
<h3 id="4-7-3-增加、修改、替换列信息"><a href="#4-7-3-增加、修改、替换列信息" class="headerlink" title="4.7.3 增加、修改、替换列信息"></a>4.7.3 增加、修改、替换列信息</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 更新列</span>
ALTER TABLE table_name CHANGE COLUMN col_old_name col_new_name
column_type <span class="token punctuation">[</span>COMMENT col_comment<span class="token punctuation">]</span> <span class="token punctuation">[</span>FIRST<span class="token operator">|</span>AFTER column_name<span class="token punctuation">]</span>
<span class="token comment"># 增加和替换列</span>
ALTER TABLE table_name ADD<span class="token operator">|</span>REPLACE <span class="token environment constant">COLUMNS</span> <span class="token punctuation">(</span>col_name data_type
<span class="token punctuation">[</span>COMMENT col_comment<span class="token punctuation">]</span>, <span class="token punctuation">..</span>.<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>add是新增一字段，而replace则是提花表中所有的字段。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1.查询表结构</span>
desc dept<span class="token punctuation">;</span>
<span class="token comment"># 2.添加列</span>
alter table dept <span class="token function">add</span> columns <span class="token punctuation">(</span>deptdesc string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 3.更新列</span>
alter table dept change <span class="token function">column</span> deptdesc desc int<span class="token punctuation">;</span>
<span class="token comment"># 4.替换列</span>
alter table replace columns<span class="token punctuation">(</span>deptno string, dname string, loc string<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-8-删除表"><a href="#4-8-删除表" class="headerlink" title="4.8 删除表"></a>4.8 删除表</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">drop table dept<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="4-9-修复表"><a href="#4-9-修复表" class="headerlink" title="4.9 修复表"></a>4.9 修复表</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">msck repair <span class="token keyword">table</span> tablename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>MSCK REPAIR TABLE</code>命令主要是用来解决通过hdfs dfs -put或者hdfs api写入hive分区表的数据在hive中无法被查询到的问题。</p>
<p>我们知道hive有个服务叫metastore，这个服务主要是存储一些元数据信息，比如数据库名，表名或者表的分区等等信息。如果不是通过hive的insert等插入语句，很多分区信息在metastore中是没有的，如果插入分区数据量很多的话，你用 <code>ALTER TABLE table_name ADD PARTITION</code> 一个个分区添加十分麻烦。这时候<code>MSCK REPAIR TABLE</code>就派上用场了。只需要运行<code>MSCK REPAIR TABLE</code>命令，hive就会去检测这个表在hdfs上的文件，把没有写入metastore的分区信息写入metastore。</p>
<h2 id="4-10-修改表位置"><a href="#4-10-修改表位置" class="headerlink" title="4.10 修改表位置"></a>4.10 修改表位置</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> t_m_cc <span class="token keyword">set</span> location <span class="token string">'hdfs://heracles/user/video-mvc/hive/warehouse/t_m_cc'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="第五章-DML数据操作"><a href="#第五章-DML数据操作" class="headerlink" title="第五章 DML数据操作"></a>第五章 DML数据操作</h1><h2 id="5-1-数据导入"><a href="#5-1-数据导入" class="headerlink" title="5.1 数据导入"></a>5.1 数据导入</h2><h3 id="5-1-1-向表中装载数据-Load"><a href="#5-1-1-向表中装载数据-Load" class="headerlink" title="5.1.1 向表中装载数据(Load)"></a>5.1.1 向表中装载数据(Load)</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">load data <span class="token punctuation">[</span>local<span class="token punctuation">]</span> inpath <span class="token string">'filepath'</span> <span class="token punctuation">[</span>overwrite<span class="token punctuation">]</span> into table table_name <span class="token punctuation">[</span>partition<span class="token punctuation">(</span>part1<span class="token operator">=</span>val1,part2<span class="token operator">=</span>val2<span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">load data <span class="token builtin class-name">local</span> inpath <span class="token string">'/opt/moudle/dept.txt'</span> 
into<span class="token operator">|</span>overwrite into table student partition<span class="token punctuation">(</span>partcol1<span class="token operator">=</span>val1<span class="token punctuation">)</span>
row <span class="token function">format</span> delimited fields terminated by <span class="token string">','</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="5-1-2-通过查询语句向表插入数据（Insert）"><a href="#5-1-2-通过查询语句向表插入数据（Insert）" class="headerlink" title="5.1.2 通过查询语句向表插入数据（Insert）"></a>5.1.2 通过查询语句向表插入数据（Insert）</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1.基本插入数据</span>
insert into table student 
partition<span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span>
values<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">'wangwu'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 2.基本模式插入（根据单张表查询结果）</span>
insert overwrite table student 
partition<span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201708'</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> * from student where <span class="token assign-left variable">month</span><span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-1-3-查询语句中创建表并加载数据（As-Select）"><a href="#5-1-3-查询语句中创建表并加载数据（As-Select）" class="headerlink" title="5.1.3 查询语句中创建表并加载数据（As Select）"></a>5.1.3 查询语句中创建表并加载数据（As Select）</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">create table <span class="token keyword">if</span> not exists students
as <span class="token keyword">select</span> id, name from student<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="5-1-4-创建表时通过Location指定加载数据路径"><a href="#5-1-4-创建表时通过Location指定加载数据路径" class="headerlink" title="5.1.4 创建表时通过Location指定加载数据路径"></a>5.1.4 创建表时通过Location指定加载数据路径</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1.创建表，并指定在hdfs位置上</span>
create table <span class="token keyword">if</span> not exists student<span class="token punctuation">(</span>id int, name string<span class="token punctuation">)</span>
row <span class="token function">format</span> delimited fields terminated bt <span class="token string">'\t'</span>
location <span class="token string">'/user/hive/warehouse/student'</span><span class="token punctuation">;</span>
<span class="token comment"># 2.上传数据到hdfs上</span>
dfs -put /opt/modlue/student /user/hive/warehouse/student<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="5-2-数据导出"><a href="#5-2-数据导出" class="headerlink" title="5.2 数据导出"></a>5.2 数据导出</h2><h1 id="第六章-查询"><a href="#第六章-查询" class="headerlink" title="第六章 查询"></a>第六章 查询</h1><h2 id="6-1-基本查询"><a href="#6-1-基本查询" class="headerlink" title="6.1 基本查询"></a>6.1 基本查询</h2><h3 id="6-1-1-全表和特定列查询"><a href="#6-1-1-全表和特定列查询" class="headerlink" title="6.1.1 全表和特定列查询"></a>6.1.1 全表和特定列查询</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> * from emp<span class="token punctuation">;</span>
<span class="token keyword">select</span> empno, enmae from emp<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="6-1-2-列别名"><a href="#6-1-2-列别名" class="headerlink" title="6.1.2 列别名"></a>6.1.2 列别名</h3><p>就是重命名一个列，紧跟列名就完了</p>
<h3 id="6-1-3-算术运算符"><a href="#6-1-3-算术运算符" class="headerlink" title="6.1.3 算术运算符"></a>6.1.3 算术运算符</h3><ul>
<li><ul>
<li><ul>
<li>/ % &amp; | ^ ~</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="6-1-4-常用函数"><a href="#6-1-4-常用函数" class="headerlink" title="6.1.4 常用函数"></a>6.1.4 常用函数</h3><ol>
<li>count</li>
<li>max</li>
<li>min</li>
<li>sum</li>
<li>avg</li>
</ol>
<h3 id="6-1-5-Limit语句"><a href="#6-1-5-Limit语句" class="headerlink" title="6.1.5 Limit语句"></a>6.1.5 Limit语句</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> * from emp limit <span class="token number">5</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="6-2-Where语句"><a href="#6-2-Where语句" class="headerlink" title="6.2 Where语句"></a>6.2 Where语句</h2><p>where子句紧跟From子句</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> * from emp where sal <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="6-2-1-比较运算符"><a href="#6-2-1-比较运算符" class="headerlink" title="6.2.1 比较运算符"></a>6.2.1 比较运算符</h3><p>这些谓词操作符同样适用于join on和having语句中</p>
<p>A=B<br>A&lt;=&gt;B<br>A&lt;&gt;B, A != B<br>A&lt;B<br>A&lt;=B<br>A&gt;B<br>A&gt;=B<br>A [NOT] BETWEEN B AND C<br>A IS NULL<br>A IS NOT NULL<br>IN(数值1，数值2)<br>A [NOT] LIKE B<br>A RLIKE B（B是一个正则表达式）</p>
<h3 id="6-2-2-Like和RLike"><a href="#6-2-2-Like和RLike" class="headerlink" title="6.2.2 Like和RLike"></a>6.2.2 Like和RLike</h3><p>%代表零个或多个字符<br>_表示一个字符<br>RLike是Hive中这个功能的扩展，可以通过正则表达式来匹配。</p>
<h3 id="6-2-3-逻辑运算符"><a href="#6-2-3-逻辑运算符" class="headerlink" title="6.2.3 逻辑运算符"></a>6.2.3 逻辑运算符</h3><p>AND<br>OR<br>NOT</p>
<h2 id="6-3-分组"><a href="#6-3-分组" class="headerlink" title="6.3 分组"></a>6.3 分组</h2><h3 id="6-3-1-Group-By语句"><a href="#6-3-1-Group-By语句" class="headerlink" title="6.3.1 Group By语句"></a>6.3.1 Group By语句</h3><p>通常和聚合函数一起使用，用于分组计算</p>
<h3 id="6-3-2-Having语句"><a href="#6-3-2-Having语句" class="headerlink" title="6.3.2 Having语句"></a>6.3.2 Having语句</h3><ol>
<li><p>having和where不同点</p>
<p>where针对表中的列发挥作用，查询数据；having针对查询结果中的列发挥作用，筛选数据。</p>
<p>having只用于group by分组统计语句</p>
</li>
</ol>
<h2 id="6-4-Join语句"><a href="#6-4-Join语句" class="headerlink" title="6.4 Join语句"></a>6.4 Join语句</h2><h3 id="6-4-1-等值Join"><a href="#6-4-1-等值Join" class="headerlink" title="6.4.1 等值Join"></a>6.4.1 等值Join</h3><p>Hive只支持等值连接，不支持非等值连接</p>
<h3 id="6-4-2-内连接"><a href="#6-4-2-内连接" class="headerlink" title="6.4.2 内连接"></a>6.4.2 内连接</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span>
		*
from
		emp e
<span class="token function">join</span>
		dept d
on
		e.id <span class="token operator">=</span> d.id<span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-4-3-左外连接"><a href="#6-4-3-左外连接" class="headerlink" title="6.4.3 左外连接"></a>6.4.3 左外连接</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span>
		*
from
		emp e
left <span class="token function">join</span>
		dept d
on
		e.id <span class="token operator">=</span> d.id<span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-4-4-右外连接"><a href="#6-4-4-右外连接" class="headerlink" title="6.4.4 右外连接"></a>6.4.4 右外连接</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span>
		*
from
		emp e
right <span class="token function">join</span>
		dept d
on
		e.id <span class="token operator">=</span> d.id<span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-4-5-满外连接"><a href="#6-4-5-满外连接" class="headerlink" title="6.4.5 满外连接"></a>6.4.5 满外连接</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span>
		*
from
		emp e
full <span class="token function">join</span>
		dept d
on
		e.id <span class="token operator">=</span> d.id<span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>大多数情况下，Hive会对每对JOIN连接对象起一个MR，运行的顺序就是语句从左到右。</p>
<h3 id="6-4-6-笛卡尔积"><a href="#6-4-6-笛卡尔积" class="headerlink" title="6.4.6 笛卡尔积"></a>6.4.6 笛卡尔积</h3><p>产生原因</p>
<ol>
<li>join时省略了连接条件</li>
<li>连接条件无效</li>
<li>所有表中的所有行互相连接</li>
</ol>
<h3 id="6-4-7-连接谓词on中不支持or"><a href="#6-4-7-连接谓词on中不支持or" class="headerlink" title="6.4.7 连接谓词on中不支持or"></a>6.4.7 连接谓词on中不支持or</h3><h2 id="6-5-排序"><a href="#6-5-排序" class="headerlink" title="6.5 排序"></a>6.5 排序</h2><h3 id="6-5-1-全局排序（Order-By）"><a href="#6-5-1-全局排序（Order-By）" class="headerlink" title="6.5.1 全局排序（Order By）"></a>6.5.1 全局排序（Order By）</h3><ol>
<li><p>使用Order By子句排序</p>
<p>ASC：升序（默认）</p>
<p>DESC：降序</p>
</li>
<li><p>Order By子句在Select语句的结尾</p>
</li>
</ol>
<h3 id="6-5-2-每个MapReduce内部排序"><a href="#6-5-2-每个MapReduce内部排序" class="headerlink" title="6.5.2 每个MapReduce内部排序"></a>6.5.2 每个MapReduce内部排序</h3><p>sort by：每个Reducer内部进行排序，对全局结果集来说不是排序。</p>
<h3 id="6-5-3-分区排序（Distribute-By）"><a href="#6-5-3-分区排序（Distribute-By）" class="headerlink" title="6.5.3 分区排序（Distribute By）"></a>6.5.3 分区排序（Distribute By）</h3><h3 id="6-5-4-Cluster-By"><a href="#6-5-4-Cluster-By" class="headerlink" title="6.5.4 Cluster By"></a>6.5.4 Cluster By</h3><h2 id="6-6-分桶及抽样查询"><a href="#6-6-分桶及抽样查询" class="headerlink" title="6.6 分桶及抽样查询"></a>6.6 分桶及抽样查询</h2><h3 id="6-6-1-分桶表数据存储"><a href="#6-6-1-分桶表数据存储" class="headerlink" title="6.6.1 分桶表数据存储"></a>6.6.1 分桶表数据存储</h3><p>分区针对的是数据的存储路径：分桶针对的是数据文件。</p>
<h2 id="6-7-其他常用查询函数"><a href="#6-7-其他常用查询函数" class="headerlink" title="6.7 其他常用查询函数"></a>6.7 其他常用查询函数</h2><h3 id="6-7-1-空字段赋值"><a href="#6-7-1-空字段赋值" class="headerlink" title="6.7.1 空字段赋值"></a>6.7.1 空字段赋值</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 如果comm是NULL，就替换成-1</span>
nvl<span class="token punctuation">(</span>comm,-1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="6-7-2-时间类"><a href="#6-7-2-时间类" class="headerlink" title="6.7.2 时间类"></a>6.7.2 时间类</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 格式化时间</span>
date_format<span class="token punctuation">(</span><span class="token string">'2019-06-29'</span>, <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 时间跟天数相加</span>
date_add<span class="token punctuation">(</span><span class="token string">'2019-06-29'</span>,5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 时间跟天数相减</span>
date_sub<span class="token punctuation">(</span><span class="token string">'2019-06-29'</span>, <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 两个时间相减</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-7-3-CASE-WHEN"><a href="#6-7-3-CASE-WHEN" class="headerlink" title="6.7.3 CASE WHEN"></a>6.7.3 CASE WHEN</h3><p><img src="https://gitee.com/liyunh/image/raw/master/master/202110060744987.png" alt="Hive%20fea187511b6a4d358dccaf8d0bb95aa2/c28a2647781ba08b98613c9eb1e3028.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> 
	dept_id
	sum<span class="token punctuation">(</span>case sex when <span class="token string">'男'</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> end<span class="token punctuation">)</span> male_count,
	sum<span class="token punctuation">(</span>case sex when <span class="token string">'女'</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> end<span class="token punctuation">)</span> female_count
from 
	emp
group by
	dept_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-7-4-行转列"><a href="#6-7-4-行转列" class="headerlink" title="6.7.4 行转列"></a>6.7.4 行转列</h3><ol>
<li>相关函数</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 返回输入字符串连接后的结果</span>
concat<span class="token punctuation">(</span>string A/col, string B/col, <span class="token punctuation">..</span>.<span class="token punctuation">)</span>
<span class="token comment"># 特殊的concat，第一个值作为连接符使用</span>
concat_ws<span class="token punctuation">(</span>separator, str1, str2, <span class="token punctuation">..</span>.<span class="token punctuation">)</span>
<span class="token comment"># 函数只接受基本数据类型，将某字段的值进行去重汇总，产生array类型字段</span>
collect_set<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
<span class="token comment"># 不去重 </span>
collect_list<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
<span class="token comment"># 要配合group by使用</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/liyunh/image/raw/master/master/202110060744996.png" alt="Hive%20fea187511b6a4d358dccaf8d0bb95aa2/Untitled.png"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 
	t1<span class="token punctuation">.</span>base<span class="token punctuation">,</span>
	concat_ws<span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">,</span> collect_set<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> name
<span class="token keyword">from</span>	
	<span class="token punctuation">(</span><span class="token keyword">select</span>
		name<span class="token punctuation">,</span>
		concat<span class="token punctuation">(</span>constellation<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> blood_type<span class="token punctuation">)</span> base
	<span class="token keyword">from</span>
		person_info<span class="token punctuation">)</span> t1
<span class="token keyword">group</span> <span class="token keyword">by</span>
	t1<span class="token punctuation">.</span>base<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-7-5-列转行"><a href="#6-7-5-列转行" class="headerlink" title="6.7.5 列转行"></a>6.7.5 列转行</h3><ol>
<li>相关函数</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 炸列，将一列中复杂的array或map结构拆分成多行</span>

lateral view explode<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/liyunh/image/raw/master/master/202110061915481.png" alt="Hive%20fea187511b6a4d358dccaf8d0bb95aa2/Untitled%201.png"></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span>
	movie,
	category_name
from
	movie_info lateral view explode<span class="token punctuation">(</span>category<span class="token punctuation">)</span> table_tmp as category_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-7-6-窗口函数"><a href="#6-7-6-窗口函数" class="headerlink" title="6.7.6 窗口函数"></a>6.7.6 窗口函数</h3><p>我们想要既显示聚集前的数据,又要显示聚集后的数据,这时我们便引入了窗口函数。窗口函数，就是新开了一个窗口，可以按任意的规则对数据重新进行一次计算。</p>
<p><strong>当同一个select查询中存在多个窗口函数时,他们相互之间是没有影响的.每个窗口函数应用自己的规则。</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">name,orderdate,cost
jack,2015-01-01,10
tony,2015-01-02,15
jack,2015-02-03,23
tony,2015-01-04,29
jack,2015-01-05,46
jack,2015-04-06,42
tony,2015-01-07,50
jack,2015-01-08,55
mart,2015-04-08,62
mart,2015-04-09,68
neil,2015-05-10,12
mart,2015-04-11,75
neil,2015-06-12,80
mart,2015-04-13,94<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查询在2015年4月份购买过的顾客及总人数</span>
<span class="token keyword">select</span> 
	name,
	count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> over<span class="token punctuation">(</span><span class="token punctuation">)</span>
from table
where substring<span class="token punctuation">(</span>orderdate,1,7<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2015-04'</span>
group by
	name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>partition by子句</strong>就是查询分区子句，非常类似于Group By</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 顾客的购买明细及月购买总额</span>
<span class="token keyword">select</span> 
	name,
	orderdate,
	cost,
	sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by month<span class="token punctuation">(</span>orderdate<span class="token punctuation">))</span>
from table<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>order by子句</strong>会让输入的数据强制排序。Order By子句对于诸如Row_Number()，Lead()，LAG()等函数是必须的，因为如果数据无序，这些函数的结果就没有任何意义。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 将cost按照月进行累加</span>
<span class="token keyword">select</span>
	name,
	orderdate,
	cost,
	sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by month<span class="token punctuation">(</span>orderdate<span class="token punctuation">)</span> order by orderdate<span class="token punctuation">)</span>
from table<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>window子句</strong>，如果只使用partition by子句,未指定order by的话,我们的聚合是分组内的聚合，就是把by后边的内容全部聚合。使用了order by子句,未使用window子句的情况下,默认从起点到当前行。</p>
<ul>
<li>PRECEDING：往前，需要在前边加数字</li>
<li>FOLLOWING：往后</li>
<li>CURRENT ROW：当前行</li>
<li>UNBOUNDED：起点</li>
<li>UNBOUNDED PRECEDING ：前边的起点</li>
<li>UNBOUNDED FOLLOWING：后边的终点</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> name,orderdate,cost,
sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span><span class="token punctuation">)</span> as sample1,--所有行相加
sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name<span class="token punctuation">)</span> as sample2,--按name分组，组内数据相加
sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate<span class="token punctuation">)</span> as sample3,--按name分组，组内数据累加
sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate rows between UNBOUNDED PRECEDING and current row <span class="token punctuation">)</span>  as sample4 ,--和sample3一样,由起点到当前行的聚合
sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate rows between <span class="token number">1</span> PRECEDING   and current row<span class="token punctuation">)</span> as sample5, --当前行和前面一行做聚合
sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate rows between <span class="token number">1</span> PRECEDING   AND <span class="token number">1</span> FOLLOWING  <span class="token punctuation">)</span> as sample6,--当前行和前边一行及后面一行
sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate rows between current row and UNBOUNDED FOLLOWING <span class="token punctuation">)</span> as sample7 --当前行及后面所有行
from t_window<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">name    orderdate  cost  <span class="token number">1</span>   <span class="token number">2</span>  <span class="token number">3</span>   <span class="token number">4</span>    <span class="token number">5</span>   <span class="token number">6</span>   <span class="token number">7</span>
jack    <span class="token number">2015</span>-01-01  <span class="token number">10</span>  <span class="token number">661</span> <span class="token number">176</span> <span class="token number">10</span>  <span class="token number">10</span>  <span class="token number">10</span>  <span class="token number">56</span>  <span class="token number">176</span>
jack    <span class="token number">2015</span>-01-05  <span class="token number">46</span>  <span class="token number">661</span> <span class="token number">176</span> <span class="token number">56</span>  <span class="token number">56</span>  <span class="token number">56</span>  <span class="token number">111</span> <span class="token number">166</span>
jack    <span class="token number">2015</span>-01-08  <span class="token number">55</span>  <span class="token number">661</span> <span class="token number">176</span> <span class="token number">111</span> <span class="token number">111</span> <span class="token number">101</span> <span class="token number">124</span> <span class="token number">120</span>
jack    <span class="token number">2015</span>-02-03  <span class="token number">23</span>  <span class="token number">661</span> <span class="token number">176</span> <span class="token number">134</span> <span class="token number">134</span> <span class="token number">78</span>  <span class="token number">120</span> <span class="token number">65</span>
jack    <span class="token number">2015</span>-04-06  <span class="token number">42</span>  <span class="token number">661</span> <span class="token number">176</span> <span class="token number">176</span> <span class="token number">176</span> <span class="token number">65</span>  <span class="token number">65</span>  <span class="token number">42</span>
mart    <span class="token number">2015</span>-04-08  <span class="token number">62</span>  <span class="token number">661</span> <span class="token number">299</span> <span class="token number">62</span>  <span class="token number">62</span>  <span class="token number">62</span>  <span class="token number">130</span> <span class="token number">299</span>
mart    <span class="token number">2015</span>-04-09  <span class="token number">68</span>  <span class="token number">661</span> <span class="token number">299</span> <span class="token number">130</span> <span class="token number">130</span> <span class="token number">130</span> <span class="token number">205</span> <span class="token number">237</span>
mart    <span class="token number">2015</span>-04-11  <span class="token number">75</span>  <span class="token number">661</span> <span class="token number">299</span> <span class="token number">205</span> <span class="token number">205</span> <span class="token number">143</span> <span class="token number">237</span> <span class="token number">169</span>
mart    <span class="token number">2015</span>-04-13  <span class="token number">94</span>  <span class="token number">661</span> <span class="token number">299</span> <span class="token number">299</span> <span class="token number">299</span> <span class="token number">169</span> <span class="token number">169</span> <span class="token number">94</span>
neil    <span class="token number">2015</span>-05-10  <span class="token number">12</span>  <span class="token number">661</span> <span class="token number">92</span>  <span class="token number">12</span>  <span class="token number">12</span>  <span class="token number">12</span>  <span class="token number">92</span>  <span class="token number">92</span>
neil    <span class="token number">2015</span>-06-12  <span class="token number">80</span>  <span class="token number">661</span> <span class="token number">92</span>  <span class="token number">92</span>  <span class="token number">92</span>  <span class="token number">92</span>  <span class="token number">92</span>  <span class="token number">80</span>
tony    <span class="token number">2015</span>-01-02  <span class="token number">15</span>  <span class="token number">661</span> <span class="token number">94</span>  <span class="token number">15</span>  <span class="token number">15</span>  <span class="token number">15</span>  <span class="token number">44</span>  <span class="token number">94</span>
tony    <span class="token number">2015</span>-01-04  <span class="token number">29</span>  <span class="token number">661</span> <span class="token number">94</span>  <span class="token number">44</span>  <span class="token number">44</span>  <span class="token number">44</span>  <span class="token number">94</span>  <span class="token number">79</span>
tony    <span class="token number">2015</span>-01-07  <span class="token number">50</span>  <span class="token number">661</span> <span class="token number">94</span>  <span class="token number">94</span>  <span class="token number">94</span>  <span class="token number">79</span>  <span class="token number">79</span>  <span class="token number">50</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>row_number、rank、dense_rank</strong>：三个比较函数</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SELECT 
cookieid,
createtime,
pv,
RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> OVER<span class="token punctuation">(</span>PARTITION BY cookieid ORDER BY <span class="token function">pv</span> desc<span class="token punctuation">)</span> AS rn1,
DENSE_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> OVER<span class="token punctuation">(</span>PARTITION BY cookieid ORDER BY <span class="token function">pv</span> desc<span class="token punctuation">)</span> AS rn2,
ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> OVER<span class="token punctuation">(</span>PARTITION BY cookieid ORDER BY <span class="token function">pv</span> DESC<span class="token punctuation">)</span> AS rn3 
FROM lxw1234 
WHERE cookieid <span class="token operator">=</span> <span class="token string">'cookie1'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cookieid day           <span class="token function">pv</span>       rn1     rn2     rn3 

cookie1 <span class="token number">2015</span>-04-12      <span class="token number">7</span>       <span class="token number">1</span>       <span class="token number">1</span>       <span class="token number">1</span>
cookie1 <span class="token number">2015</span>-04-11      <span class="token number">5</span>       <span class="token number">2</span>       <span class="token number">2</span>       <span class="token number">2</span>
cookie1 <span class="token number">2015</span>-04-15      <span class="token number">4</span>       <span class="token number">3</span>       <span class="token number">3</span>       <span class="token number">3</span>
cookie1 <span class="token number">2015</span>-04-16      <span class="token number">4</span>       <span class="token number">3</span>       <span class="token number">3</span>       <span class="token number">4</span>
cookie1 <span class="token number">2015</span>-04-13      <span class="token number">3</span>       <span class="token number">5</span>       <span class="token number">4</span>       <span class="token number">5</span>
cookie1 <span class="token number">2015</span>-04-14      <span class="token number">2</span>       <span class="token number">6</span>       <span class="token number">5</span>       <span class="token number">6</span>
cookie1 <span class="token number">2015</span>-04-10      <span class="token number">1</span>       <span class="token number">7</span>       <span class="token number">6</span>       <span class="token number">7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>rank和row_number是不留空位的</p>
<p><strong>LAG和LEAD函数</strong></p>
<p>这两个函数为常用的窗口函数,可以返回上下数据行的数据。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查看顾客上次的购买时间</span>
<span class="token keyword">select</span> name,orderdate,cost,
lag<span class="token punctuation">(</span>orderdate,1,<span class="token string">'1900-01-01'</span><span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate <span class="token punctuation">)</span> as time1,
lag<span class="token punctuation">(</span>orderdate,2<span class="token punctuation">)</span> over <span class="token punctuation">(</span>partition by name order by orderdate<span class="token punctuation">)</span> as time2
from t_window<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">name    orderdate   cost    time1   time2
jack    <span class="token number">2015</span>-01-01  <span class="token number">10</span>  <span class="token number">1900</span>-01-01  NULL
jack    <span class="token number">2015</span>-01-05  <span class="token number">46</span>  <span class="token number">2015</span>-01-01  NULL
jack    <span class="token number">2015</span>-01-08  <span class="token number">55</span>  <span class="token number">2015</span>-01-05  <span class="token number">2015</span>-01-01
jack    <span class="token number">2015</span>-02-03  <span class="token number">23</span>  <span class="token number">2015</span>-01-08  <span class="token number">2015</span>-01-05
jack    <span class="token number">2015</span>-04-06  <span class="token number">42</span>  <span class="token number">2015</span>-02-03  <span class="token number">2015</span>-01-08
mart    <span class="token number">2015</span>-04-08  <span class="token number">62</span>  <span class="token number">1900</span>-01-01  NULL
mart    <span class="token number">2015</span>-04-09  <span class="token number">68</span>  <span class="token number">2015</span>-04-08  NULL
mart    <span class="token number">2015</span>-04-11  <span class="token number">75</span>  <span class="token number">2015</span>-04-09  <span class="token number">2015</span>-04-08
mart    <span class="token number">2015</span>-04-13  <span class="token number">94</span>  <span class="token number">2015</span>-04-11  <span class="token number">2015</span>-04-09
neil    <span class="token number">2015</span>-05-10  <span class="token number">12</span>  <span class="token number">1900</span>-01-01  NULL
neil    <span class="token number">2015</span>-06-12  <span class="token number">80</span>  <span class="token number">2015</span>-05-10  NULL
tony    <span class="token number">2015</span>-01-02  <span class="token number">15</span>  <span class="token number">1900</span>-01-01  NULL
tony    <span class="token number">2015</span>-01-04  <span class="token number">29</span>  <span class="token number">2015</span>-01-02  NULL
tony    <span class="token number">2015</span>-01-07  <span class="token number">50</span>  <span class="token number">2015</span>-01-04  <span class="token number">2015</span>-01-02<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>first_value和last_value</strong></p>
<p>first_value取分组内排序后，截止到当前行，第一个值</p>
<p>last_value取分组内排序后，截止到当前行，最后一个值</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> name,orderdate,cost,
first_value<span class="token punctuation">(</span>orderdate<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate<span class="token punctuation">)</span> as time1,
last_value<span class="token punctuation">(</span>orderdate<span class="token punctuation">)</span> over<span class="token punctuation">(</span>partition by name order by orderdate<span class="token punctuation">)</span> as time2
from t_window<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">name    orderdate   cost    time1   time2
jack    <span class="token number">2015</span>-01-01  <span class="token number">10</span>  <span class="token number">2015</span>-01-01  <span class="token number">2015</span>-01-01
jack    <span class="token number">2015</span>-01-05  <span class="token number">46</span>  <span class="token number">2015</span>-01-01  <span class="token number">2015</span>-01-05
jack    <span class="token number">2015</span>-01-08  <span class="token number">55</span>  <span class="token number">2015</span>-01-01  <span class="token number">2015</span>-01-08
jack    <span class="token number">2015</span>-02-03  <span class="token number">23</span>  <span class="token number">2015</span>-01-01  <span class="token number">2015</span>-02-03
jack    <span class="token number">2015</span>-04-06  <span class="token number">42</span>  <span class="token number">2015</span>-01-01  <span class="token number">2015</span>-04-06
mart    <span class="token number">2015</span>-04-08  <span class="token number">62</span>  <span class="token number">2015</span>-04-08  <span class="token number">2015</span>-04-08
mart    <span class="token number">2015</span>-04-09  <span class="token number">68</span>  <span class="token number">2015</span>-04-08  <span class="token number">2015</span>-04-09
mart    <span class="token number">2015</span>-04-11  <span class="token number">75</span>  <span class="token number">2015</span>-04-08  <span class="token number">2015</span>-04-11
mart    <span class="token number">2015</span>-04-13  <span class="token number">94</span>  <span class="token number">2015</span>-04-08  <span class="token number">2015</span>-04-13
neil    <span class="token number">2015</span>-05-10  <span class="token number">12</span>  <span class="token number">2015</span>-05-10  <span class="token number">2015</span>-05-10
neil    <span class="token number">2015</span>-06-12  <span class="token number">80</span>  <span class="token number">2015</span>-05-10  <span class="token number">2015</span>-06-12
tony    <span class="token number">2015</span>-01-02  <span class="token number">15</span>  <span class="token number">2015</span>-01-02  <span class="token number">2015</span>-01-02
tony    <span class="token number">2015</span>-01-04  <span class="token number">29</span>  <span class="token number">2015</span>-01-02  <span class="token number">2015</span>-01-04
tony    <span class="token number">2015</span>-01-07  <span class="token number">50</span>  <span class="token number">2015</span>-01-02  <span class="token number">2015</span>-01-07<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>NTILE(n)：</strong>把有序分区中的行分发到指定数据的组中，各个组有编号，编号从 1 开始，对于每一行，NTILE 返回此行所属的组的编号。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查询前20%时间的订单信息</span>
<span class="token keyword">select</span> 
	*
from （
	<span class="token keyword">select</span>
		name,
		orderdate,
		cost,
		ntile<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> over <span class="token punctuation">(</span>order by orderdate<span class="token punctuation">)</span> sorted
	from
		business
<span class="token punctuation">)</span> t
where sorted <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-7-7-小数点转换"><a href="#6-7-7-小数点转换" class="headerlink" title="6.7.7 小数点转换"></a>6.7.7 小数点转换</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">format_number<span class="token punctuation">(</span>number<span class="token punctuation">,</span> <span class="token keyword">int</span> d<span class="token punctuation">)</span> 这个方法返回的是字符串
cast<span class="token punctuation">(</span>number <span class="token keyword">as</span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="6-7-8-补齐函数"><a href="#6-7-8-补齐函数" class="headerlink" title="6.7.8 补齐函数"></a>6.7.8 补齐函数</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- string1:源字符串</span>
<span class="token comment">-- 即最终结果返回的字符串的长度，如果这个值长的话就做截断处理，短的话就拿string2填补</span>
<span class="token comment">-- string2:用于填充的字符，可以不填，默认为空字符</span>
<span class="token comment">-- l：从左侧开始补齐； r：从右侧开始补齐</span>
lpad<span class="token punctuation">(</span>string1<span class="token punctuation">,</span> length<span class="token punctuation">,</span> string2<span class="token punctuation">)</span>
rpad<span class="token punctuation">(</span>string1<span class="token punctuation">,</span> length<span class="token punctuation">,</span> string2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="第七章-函数"><a href="#第七章-函数" class="headerlink" title="第七章 函数"></a>第七章 函数</h1><h2 id="7-1-系统内置函数"><a href="#7-1-系统内置函数" class="headerlink" title="7.1 系统内置函数"></a>7.1 系统内置函数</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查看系统自带的函数</span>
show functions<span class="token punctuation">;</span>
<span class="token comment"># 显示自带函数的用法</span>
desc <span class="token keyword">function</span> upper<span class="token punctuation">;</span>
<span class="token comment"># 显示自带的函数的用法</span>
desc <span class="token keyword">function</span> extended upper<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="7-2-自定义函数"><a href="#7-2-自定义函数" class="headerlink" title="7.2 自定义函数"></a>7.2 自定义函数</h2><ol>
<li>UDF：一进一出</li>
<li>UDAF：多进一出</li>
<li>UDTF：多进多出</li>
</ol>
<h3 id="7-2-1-自定义UDF函数"><a href="#7-2-1-自定义UDF函数" class="headerlink" title="7.2.1 自定义UDF函数"></a>7.2.1 自定义UDF函数</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>dependency<span class="token operator">></span>
		<span class="token operator">&lt;</span>groupId<span class="token operator">></span>org.apache.hive<span class="token operator">&lt;</span>/groupId<span class="token operator">></span>
		<span class="token operator">&lt;</span>artifactId<span class="token operator">></span>hive-exec<span class="token operator">&lt;</span>/artifactId<span class="token operator">></span>
		<span class="token operator">&lt;</span>version<span class="token operator">></span>?.?.?<span class="token operator">&lt;</span>/version<span class="token operator">></span>
<span class="token operator">&lt;</span>/dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><p>继承UDF类</p>
</li>
<li><p>重写evaluate</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>ql<span class="token punctuation">.</span>exec<span class="token punctuation">.</span></span>UDF<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Lower</span> <span class="token keyword">extends</span> UDF <span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token class-name">String</span> evaluate <span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
						<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>
				<span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h3 id="7-2-2-自定义UDTF函数"><a href="#7-2-2-自定义UDTF函数" class="headerlink" title="7.2.2 自定义UDTF函数"></a>7.2.2 自定义UDTF函数</h3><ol>
<li>继承类</li>
<li>重写initialize，process和close方法</li>
</ol>
<h3 id="7-2-3-使用自定义函数"><a href="#7-2-3-使用自定义函数" class="headerlink" title="7.2.3 使用自定义函数"></a>7.2.3 使用自定义函数</h3><p>mysql存储元数据，HDFS存储实际数据，如果两个能对上，hive就可以进行操作</p>
<h1 id="第八章-报错"><a href="#第八章-报错" class="headerlink" title="第八章 报错"></a>第八章 报错</h1><h2 id="8-1-MismatchedTokenException-318-326"><a href="#8-1-MismatchedTokenException-318-326" class="headerlink" title="8.1 MismatchedTokenException(318!=326)"></a>8.1 MismatchedTokenException(318!=326)</h2><p>这个问题是因为没有使用dt=’2020-02-13’这个格式。</p>
<h2 id="8-2-cannot-recognize-input-near-‘2020’-‘-‘-‘09’-in-function-specification"><a href="#8-2-cannot-recognize-input-near-‘2020’-‘-‘-‘09’-in-function-specification" class="headerlink" title="8.2 cannot recognize input near ‘2020’ ‘-‘ ‘09’ in function specification"></a>8.2 cannot recognize input near ‘2020’ ‘-‘ ‘09’ in function specification</h2><p>对半是因为少逗号之类的</p>
<h2 id="8-3-7-missing-EOF-at-‘by’-near-‘group’"><a href="#8-3-7-missing-EOF-at-‘by’-near-‘group’" class="headerlink" title="8.3 7 missing EOF at ‘by’ near ‘group’"></a>8.3 7 missing EOF at ‘by’ near ‘group’</h2><p>hive本身缺陷，需要在每个子查询后面加别名。</p>
<h2 id="8-经验"><a href="#8-经验" class="headerlink" title="8. 经验"></a>8. 经验</h2><h3 id="8-2-1-hive和MySQL之间数据对不上"><a href="#8-2-1-hive和MySQL之间数据对不上" class="headerlink" title="8.2.1 hive和MySQL之间数据对不上"></a>8.2.1 hive和MySQL之间数据对不上</h3><ol>
<li>mysql中添加了新的字段，导致没有同步到hive中呢。</li>
<li>hive同步的时间没有到，导致数据滞后一天。</li>
</ol>
<h3 id="8-2-2-时间维表"><a href="#8-2-2-时间维表" class="headerlink" title="8.2.2 时间维表"></a>8.2.2 时间维表</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>dim_date<span class="token punctuation">`</span><span class="token punctuation">(</span>
  <span class="token punctuation">`</span>v_date<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>date_int<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>date_short<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>date_medium<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>date_long<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>date_full<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>day_in_year<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>day_in_month<span class="token punctuation">`</span> <span class="token keyword">tinyint</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>is_first_day_in_month<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>is_last_day_in_month<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>day_name<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>week_in_year<span class="token punctuation">`</span> <span class="token keyword">tinyint</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>week_in_month<span class="token punctuation">`</span> <span class="token keyword">tinyint</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>is_first_day_in_week<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>is_last_day_in_week<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>month_number<span class="token punctuation">`</span> <span class="token keyword">tinyint</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>month_name<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>year2<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>year4<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>quarter_name<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>quarter_number<span class="token punctuation">`</span> <span class="token keyword">tinyint</span><span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>year_quarter<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>year_month_number<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>last_date<span class="token punctuation">`</span> string<span class="token punctuation">,</span> 
  <span class="token punctuation">`</span>week_in_year_for_monday<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">COMMENT</span> <span class="token string">'时间维表'</span>
<span class="token keyword">ROW</span> FORMAT SERDE 
  <span class="token string">'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'</span> 
<span class="token keyword">WITH</span> SERDEPROPERTIES <span class="token punctuation">(</span> 
  <span class="token string">'field.delim'</span><span class="token operator">=</span><span class="token string">'\u0001'</span><span class="token punctuation">,</span> 
  <span class="token string">'line.delim'</span><span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">,</span> 
  <span class="token string">'serialization.format'</span><span class="token operator">=</span><span class="token string">'\u0001'</span><span class="token punctuation">)</span> 
STORED <span class="token keyword">AS</span> INPUTFORMAT 
  <span class="token string">'org.apache.hadoop.mapred.TextInputFormat'</span> 
OUTPUTFORMAT 
  <span class="token string">'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="8-3-3-自然周计算方法"><a href="#8-3-3-自然周计算方法" class="headerlink" title="8.3.3 自然周计算方法"></a>8.3.3 自然周计算方法</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">concat<span class="token punctuation">(</span><span class="token keyword">if</span><span class="token punctuation">(</span>pmod<span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> <span class="token string">'1920-01-01'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> date_sub<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> date_sub<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> pmod<span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> <span class="token string">'1920-01-01'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'~'</span><span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">(</span>pmod<span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> <span class="token string">'1920-01-01'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v_date<span class="token punctuation">,</span> date_add<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> <span class="token number">7</span> <span class="token operator">-</span> pmod<span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> <span class="token string">'1920-01-01'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 0-6 : 0 就表示为周日</span>
pmod<span class="token punctuation">(</span>datediff<span class="token punctuation">(</span>v_date<span class="token punctuation">,</span> <span class="token string">'1920-01-01'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>运行顺序：</p>
<p>(7) SELECT</p>
<p>(8) DISTINCT <select_list></p>
<p>(1) FROM <left_table></p>
<p>(3) <join_type> JOIN <right_table></p>
<p>(2) ON <join_condition></p>
<p>(4) WHERE <where_condition></p>
<p>(5) GROUP BY <group_by_list></p>
<p>(6) HAVING <having_condition></p>
<p>(9) ORDER BY <order_by_condition></p>
<p>(10) LIMIT <limit_number></p>
<p>调优</p>
<p>谓词下推</p>
<p>就是在不影响结果的情况下，尽量将过滤条件提前执行。谓词下推后，过滤条件在map端执行，减少了map端的输出。</p>
<p>1、对于Join(Inner Join)、Full outer Join，条件写在on后面，还是where后面，性能上面没有区别；</p>
<p>2、对于Left outer Join ，右侧的表写在on后面、左侧的表写在where后面，性能上有提高；</p>
<p>3、对于Right outer Join，左侧的表写在on后面、右侧的表写在where后面，性能上有提高；</p>
<p>array_contains 列表包含</p>
<p>Failed with exception java.io.IOException:java.lang.ClassCastException: org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveArrayInspector cannot be cast to org.apache.hadoop.hive.serde2.objectinspector.PrimitiveObjectInspector</p>
<p>查看端口</p>
<p>set hive.server2.thrift.port</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/3.BigData/hive.html" data-id="ckujlxfn60002p53n0divchah" data-title="Hive" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-4.Language/markdown" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/4.Language/markdown.html" class="article-date">
  <time class="dt-published" datetime="2021-10-05T12:49:23.450Z" itemprop="datePublished">2021-10-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/post/4.Language/markdown.html">Markdown</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[toc]</p>
<h1 id="Mermaid"><a href="#Mermaid" class="headerlink" title="Mermaid"></a>Mermaid</h1><pre class="mermaid">classDiagram

  Class01 <|-- AveryLongClass: Cool
  <<interface>> Class01
  Class09-->C2: Where am i?
  Class09 --* C3
  Class09 --|> Class07
  Class07: equals()
  Class07: Object[] elementData
  Class01: size()
  Class01: int chimp
  Class01: int gorilla
  class Class10 {
    <<service>>
    int id
    size()
  }</pre>

<pre class="mermaid">classDiagram
    classA --|> classB : 继承
    classC --* classD : 组合
    classE --o classF : 聚合
    classG --> classH : 单向关联
    classI -- classJ : 双向关联
    classK ..> classL : 依赖
    classM ..|> classN : 接口实现
    classO .. classP : Link(Dashed)</pre>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mybdss/p/14958781.html">https://www.cnblogs.com/mybdss/p/14958781.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/4.Language/markdown.html" data-id="ckujlxfmn0001p53ne4me21zu" data-title="Markdown" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2.Computer Basics/设计模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/post/2.Computer%20Basics/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" class="article-date">
  <time class="dt-published" datetime="2021-09-30T09:50:48.396Z" itemprop="datePublished">2021-09-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/post/2.Computer%20Basics/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html">设计模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>设计模式出现的原因是因为由面向过程编程改成了面向对象编程。面向对象编程的好处有以下几点，以活字印刷为例：</p>
<ol>
<li>可维护。改文章的话，只需要改字</li>
<li>可复用。以前的文字，现在还可以用</li>
<li>可拓展。如果需要新加字，另外新刻字就可以了</li>
<li>灵活性好。字是最小单元，可以随意调整</li>
</ol>
<h1 id="一-UML知识"><a href="#一-UML知识" class="headerlink" title="一 UML知识"></a>一 UML知识</h1><p><img src="https://gitee.com/liyunh/image/raw/master/master/202110060749537.png" alt="Untitled"></p>
<hr>
<h1 id="二-设计原则"><a href="#二-设计原则" class="headerlink" title="二 设计原则"></a>二 设计原则</h1><h2 id="2-1-单一职责原则"><a href="#2-1-单一职责原则" class="headerlink" title="2.1 单一职责原则"></a>2.1 单一职责原则</h2><p>就一个类而言，应该仅有一个引起它变化的原因</p>
<h2 id="2-2-开放封闭原则"><a href="#2-2-开放封闭原则" class="headerlink" title="2.2 开放封闭原则"></a>2.2 开放封闭原则</h2><p>扩展是开放的，修改是封闭的。面对需求时，对程序的改动是通过增加新代码进行的，而不是更改现有的代码。拒绝不成熟的抽象和抽象本身同样重要。</p>
<h2 id="2-3-依赖倒转原则"><a href="#2-3-依赖倒转原则" class="headerlink" title="2.3 依赖倒转原则"></a>2.3 依赖倒转原则</h2><p>抽象不依赖细节，细节应该依赖抽象。就是要针对接口编程，不要针对实现编程。程序中所有的依赖关系都应该是终止于抽象类或者接口，那就是面向对象设计，反之就是面向过程设计。</p>
<h2 id="2-4-里氏代换原则"><a href="#2-4-里氏代换原则" class="headerlink" title="2.4 里氏代换原则"></a>2.4 里氏代换原则</h2><p>子类型必须能够替换掉父类型</p>
<h1 id="三-创建型模式（5种）"><a href="#三-创建型模式（5种）" class="headerlink" title="三 创建型模式（5种）"></a>三 创建型模式（5种）</h1><p>这些设计模式提供了一种在创建对象的同时隐藏创建逻辑的方式，而不是使用 new 运算符直接实例化对象。这使得程序在判断针对某个给定实例需要创建哪些对象时更加灵活。</p>
<h2 id="3-1-简单工厂（Simple-Factory）模式（常用）"><a href="#3-1-简单工厂（Simple-Factory）模式（常用）" class="headerlink" title="3.1 简单工厂（Simple Factory）模式（常用）"></a>3.1 简单工厂（Simple Factory）模式（常用）</h2><h3 id="3-1-1-使用场景"><a href="#3-1-1-使用场景" class="headerlink" title="3.1.1 使用场景"></a>3.1.1 使用场景</h3><h3 id="3-1-2-类图"><a href="#3-1-2-类图" class="headerlink" title="3.1.2 类图"></a>3.1.2 类图</h3><pre class="mermaid">classDiagram

class Phone {
    <<abstract>>
    +produce() Phone 
}
class XiaoMiPhone {
    +produce() XiaoMiPhone
}
class IPhone {
    +produce() IPhone
}
class Factory {
    +producePhone(String type) Phone
}

Phone <|-- XiaoMiPhone
Phone <|-- IPhone
Phone <.. Factory</pre>

<h3 id="3-1-3-代码实现"><a href="#3-1-3-代码实现" class="headerlink" title="3.1.3 代码实现"></a>3.1.3 代码实现</h3><p><strong>Phone类</strong>：手机标准规范类(AbstractProduct)</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Phone</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">void</span> <span class="token function">produce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>MiPhone类</strong>：制造小米手机（Product1）</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XiaoMiPhone</span> extend <span class="token class-name">Phone</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">public</span> <span class="token class-name">XiaoMiPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">produce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">produce</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token comment">// TODO Auto-generated method stub</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"make xiaomi phone!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>IPhone类</strong>：制造苹果手机（Product2）</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IPhone</span> <span class="token keyword">implements</span> <span class="token class-name">Phone</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">public</span> <span class="token class-name">IPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">produce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">produce</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token comment">// TODO Auto-generated method stub</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"make iphone!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>PhoneFactory类</strong>：手机代工厂（Factory）</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Factory</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">public</span> <span class="token class-name">Phone</span> <span class="token function">producePhone</span><span class="token punctuation">(</span><span class="token class-name">String</span> phoneType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>phoneType<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span><span class="token string">"MiPhone"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
             <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MiPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">&#125;</span>
         <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>phoneType<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span><span class="token string">"iPhone"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
             <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">IPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">&#125;</span>
         <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>演示：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token class-name">PhoneFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhoneFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">Phone</span> miPhone <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">makePhone</span><span class="token punctuation">(</span><span class="token string">"MiPhone"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// make xiaomi phone!</span>
         <span class="token class-name">IPhone</span> iPhone <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">IPhone</span><span class="token punctuation">)</span>factory<span class="token punctuation">.</span><span class="token function">makePhone</span><span class="token punctuation">(</span><span class="token string">"iPhone"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// make iphone!</span>
     <span class="token punctuation">&#125;</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-1-2-工厂方法模式-Factory-Method"><a href="#1-1-2-工厂方法模式-Factory-Method" class="headerlink" title="1.1.2 工厂方法模式(Factory Method)"></a>1.1.<strong>2 工厂方法模式(Factory Method)</strong></h3><p>和简单工厂模式中工厂负责生产所有产品相比，工厂方法模式将生成具体产品的任务分发给具体的产品工厂，其UML类图如下：</p>
<p><img src="https://img2018.cnblogs.com/blog/1419489/201906/1419489-20190628154133368-906051111.png" alt="https://img2018.cnblogs.com/blog/1419489/201906/1419489-20190628154133368-906051111.png"></p>
<p>也就是定义一个抽象工厂，其定义了产品的生产接口，但不负责具体的产品，将生产任务交给不同的派生类工厂。这样不用通过指定类型来创建对象了。</p>
<p>接下来继续使用生产手机的例子来讲解该模式。</p>
<p>其中和产品相关的Phone类、MiPhone类和IPhone类的定义不变。</p>
<p><strong>AbstractFactory类</strong>：生产不同产品的工厂的抽象类</p>
<pre class="line-numbers language-none"><code class="language-none"> public interface AbstractFactory &#123;
     Phone makePhone();
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>XiaoMiFactory类</strong>：生产小米手机的工厂（ConcreteFactory1）</p>
<pre class="line-numbers language-none"><code class="language-none"> public class XiaoMiFactory implements AbstractFactory&#123;
     @Override
     public Phone makePhone() &#123;
         return new MiPhone();
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>AppleFactory类</strong>：生产苹果手机的工厂（ConcreteFactory2）</p>
<pre class="line-numbers language-none"><code class="language-none"> public class AppleFactory implements AbstractFactory &#123;
     @Override
     public Phone makePhone() &#123;
         return new IPhone();
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>演示：</strong></p>
<pre class="line-numbers language-none"><code class="language-none"> public class Demo &#123;
     public static void main(String[] arg) &#123;
         AbstractFactory miFactory &#x3D; new XiaoMiFactory();
         AbstractFactory appleFactory &#x3D; new AppleFactory();
         miFactory.makePhone();            &#x2F;&#x2F; make xiaomi phone!
         appleFactory.makePhone();        &#x2F;&#x2F; make iphone!
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-1-3-抽象工厂模式-Abstract-Factory"><a href="#1-1-3-抽象工厂模式-Abstract-Factory" class="headerlink" title="1.1.3 抽象工厂模式(Abstract Factory)"></a>1.1.<strong>3 抽象工厂模式(Abstract Factory)</strong></h3><p>上面两种模式不管工厂怎么拆分抽象，都只是针对一类产品<strong>Phone</strong>（AbstractProduct），如果要生成另一种产品PC，应该怎么表示呢？</p>
<p>最简单的方式是把2中介绍的工厂方法模式完全复制一份，不过这次生产的是PC。但同时也就意味着我们要完全复制和修改Phone生产管理的所有代码，显然这是一个笨办法，并不利于扩展和维护。</p>
<p>抽象工厂模式通过在AbstarctFactory中增加创建产品的接口，并在具体子工厂中实现新加产品的创建，当然前提是子工厂支持生产该产品。否则继承的这个接口可以什么也不干。</p>
<p>其UML类图如下：</p>
<p><img src="https://gitee.com/liyunh/image/raw/master/master/202110060739224.png" alt="https://img2018.cnblogs.com/blog/1419489/201906/1419489-20190628170705865-1781414242.png"></p>
<p>从上面类图结构中可以清楚的看到如何在工厂方法模式中通过增加新产品接口来实现产品的增加的。</p>
<p>接下来我们继续通过小米和苹果产品生产的例子来解释该模式。</p>
<p>为了弄清楚上面的结构，我们使用具体的产品和工厂来表示上面的UML类图，能更加清晰的看出模式是如何演变的：</p>
<p><img src="https://gitee.com/liyunh/image/raw/master/master/202110060739252.png" alt="https://img2018.cnblogs.com/blog/1419489/201906/1419489-20190628164001258-637961514.png"></p>
<p><strong>PC类</strong>：定义PC产品的接口(AbstractPC)</p>
<pre class="line-numbers language-none"><code class="language-none"> public interface PC &#123;
     void make();
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>MiPC类</strong>：定义小米电脑产品(MIPC)</p>
<pre class="line-numbers language-none"><code class="language-none"> public class MiPC implements PC &#123;
     public MiPC() &#123;
         this.make();
     &#125;
     @Override
     public void make() &#123;
         &#x2F;&#x2F; TODO Auto-generated method stub
         System.out.println(&quot;make xiaomi PC!&quot;);
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>MAC类</strong>：定义苹果电脑产品(MAC)</p>
<pre class="line-numbers language-none"><code class="language-none"> public class MAC implements PC &#123;
     public MAC() &#123;
         this.make();
     &#125;
     @Override
     public void make() &#123;
         &#x2F;&#x2F; TODO Auto-generated method stub
         System.out.println(&quot;make MAC!&quot;);
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>下面需要修改工厂相关的类的定义：</p>
<p><strong>AbstractFactory类</strong>：增加PC产品制造接口</p>
<pre class="line-numbers language-none"><code class="language-none"> public interface AbstractFactory &#123;
     Phone makePhone();
     PC makePC();
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>XiaoMiFactory类</strong>：增加小米PC的制造（ConcreteFactory1）</p>
<pre class="line-numbers language-none"><code class="language-none"> public class XiaoMiFactory implements AbstractFactory&#123;
     @Override
     public Phone makePhone() &#123;
         return new MiPhone();
     &#125;
     @Override
     public PC makePC() &#123;
         return new MiPC();
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>AppleFactory类</strong>：增加苹果PC的制造（ConcreteFactory2）</p>
<pre class="line-numbers language-none"><code class="language-none"> public class AppleFactory implements AbstractFactory &#123;
     @Override
     public Phone makePhone() &#123;
         return new IPhone();
     &#125;
     @Override
     public PC makePC() &#123;
         return new MAC();
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>演示：</strong></p>
<pre class="line-numbers language-none"><code class="language-none"> public class Demo &#123;
     public static void main(String[] arg) &#123;
         AbstractFactory miFactory &#x3D; new XiaoMiFactory();
         AbstractFactory appleFactory &#x3D; new AppleFactory();
         miFactory.makePhone();            &#x2F;&#x2F; make xiaomi phone!
         miFactory.makePC();                &#x2F;&#x2F; make xiaomi PC!
         appleFactory.makePhone();        &#x2F;&#x2F; make iphone!
         appleFactory.makePC();            &#x2F;&#x2F; make MAC!
     &#125;
 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a><strong>总结：</strong></h3><p>上面介绍的三种工厂模式有各自的应用场景，实际应用时能解决问题满足需求即可，可灵活变通，无所谓高级与低级。</p>
<h2 id="1-2-抽象工厂（Factory-Method）模式（常用）"><a href="#1-2-抽象工厂（Factory-Method）模式（常用）" class="headerlink" title="1.2 抽象工厂（Factory Method）模式（常用）"></a><strong>1.2 抽象工厂（Factory Method）模式（常用）</strong></h2><h2 id="1-3-单例（Singleton）模式（常用）"><a href="#1-3-单例（Singleton）模式（常用）" class="headerlink" title="1.3 单例（Singleton）模式（常用）"></a><strong>1.3 单例（Singleton）模式（常用）</strong></h2><h2 id="1-4-建造者（Builder）模式"><a href="#1-4-建造者（Builder）模式" class="headerlink" title="1.4 建造者（Builder）模式"></a><strong>1.4 建造者（Builder）模式</strong></h2><h2 id="1-5-原型（Prototype）模式"><a href="#1-5-原型（Prototype）模式" class="headerlink" title="1.5 原型（Prototype）模式"></a><strong>1.5 原型（Prototype）模式</strong></h2><h1 id="三-结构型模式（7种）"><a href="#三-结构型模式（7种）" class="headerlink" title="三 结构型模式（7种）"></a><strong>三 结构型模式（7种）</strong></h1><p>这些设计模式关注类和对象的组合。继承的概念被用来组合接口和定义组合对象获得新功能的方式。</p>
<h2 id="3-1-适配器模式（Adapter）"><a href="#3-1-适配器模式（Adapter）" class="headerlink" title="3.1 适配器模式（Adapter）"></a>3.1 适配器模式（Adapter）</h2><h2 id="2-装饰（Decorator）模式"><a href="#2-装饰（Decorator）模式" class="headerlink" title=".2 装饰（Decorator）模式"></a><strong>.2 装饰（Decorator）模式</strong></h2><h3 id="3-2-1-说明"><a href="#3-2-1-说明" class="headerlink" title="3.2.1 说明"></a>3.2.1 说明</h3><p>装饰器模式（Decorator Pattern）允许向一个现有的对象添加新的功能，同时又不改变其结构。这种类型的设计模式属于结构型模式，它是作为现有的类的一个包装。</p>
<p>这种模式创建了一个装饰类，用来包装原有的类，并在保持类方法签名完整性的前提下，提供了额外的功能。</p>
<h3 id="3-2-2-类图"><a href="#3-2-2-类图" class="headerlink" title="3.2.2 类图"></a>3.2.2 类图</h3><h2 id="2-3-代理（Proxy）模式（常用）"><a href="#2-3-代理（Proxy）模式（常用）" class="headerlink" title="2.3 代理（Proxy）模式（常用）"></a><strong>2.3 代理（Proxy）模式（常用）</strong></h2><h2 id="2-4-外观-门面（Facade）模式"><a href="#2-4-外观-门面（Facade）模式" class="headerlink" title="2.4 外观/门面（Facade）模式"></a><strong>2.4 外观/门面（Facade）模式</strong></h2><h2 id="2-5-桥接（Bridge）模式"><a href="#2-5-桥接（Bridge）模式" class="headerlink" title="2.5 桥接（Bridge）模式"></a><strong>2.5 桥接（Bridge）模式</strong></h2><h2 id="2-6-组合-合成（Composite）模式"><a href="#2-6-组合-合成（Composite）模式" class="headerlink" title="2.6 组合/合成（Composite）模式"></a><strong>2.6 组合/合成（Composite）模式</strong></h2><h2 id="2-7-享元（Flyweight-Pattern）模式"><a href="#2-7-享元（Flyweight-Pattern）模式" class="headerlink" title="2.7 享元（Flyweight Pattern）模式"></a><strong>2.7 享元（Flyweight Pattern）模式</strong></h2><h1 id="五-行为型模式（11种）："><a href="#五-行为型模式（11种）：" class="headerlink" title="五 行为型模式（11种）："></a>五 行为型模式（11种）：</h1><p>主要用于描述类或者对象怎样交互和怎样分配职责。</p>
<h2 id="1-策略（Strategy）模式"><a href="#1-策略（Strategy）模式" class="headerlink" title=".1 策略（Strategy）模式"></a>.1 策略（Strategy）模式</h2><h3 id="5-1-1-说明"><a href="#5-1-1-说明" class="headerlink" title="5.1.1 说明"></a>5.1.1 说明</h3><p>在策略模式（Strategy Pattern）中，一个类的行为或其算法可以在运行时更改。这种类型的设计模式属于行为型模式。</p>
<p>在策略模式中，我们创建表示各种策略的对象和一个行为随着策略对象改变而改变的 context 对象。策略对象改变 context 对象的执行算法。</p>
<h3 id="5-1-2-类图"><a href="#5-1-2-类图" class="headerlink" title="5.1.2 类图"></a>5.1.2 类图</h3><pre class="mermaid">classDiagram

class Strategy {
    <<abstract>>
    +fun()
}

class StrategyA {
    +fun()
}
class StrategyB {
    +fun()
}
class Context {
    +context()
}

Strategy <|-- StrategyA
Strategy <|-- StrategyB
Strategy --o Context</pre>

<h3 id="5-1-3-代码实现"><a href="#5-1-3-代码实现" class="headerlink" title="5.1.3 代码实现"></a>5.1.3 代码实现</h3><p><strong>Strategy</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Strategy</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">int</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">,</span> <span class="token keyword">int</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>StrategyA</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Add</span> <span class="token keyword">implements</span> <span class="token class-name">Strategy</span><span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">,</span> <span class="token keyword">int</span> num2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>StrategyB</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sub</span> <span class="token keyword">implements</span> <span class="token class-name">Strategy</span><span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">,</span> <span class="token keyword">int</span> num2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> num1 <span class="token operator">-</span> num2<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Context</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Context</span> <span class="token punctuation">&#123;</span>
    
    <span class="token keyword">private</span> <span class="token class-name">Strategy</span> strategy<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token class-name">Strategy</span> strategy<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>strategy <span class="token operator">=</span> strategy<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">doStrategy</span><span class="token punctuation">(</span><span class="token keyword">int</span> num1<span class="token punctuation">,</span> <span class="token keyword">int</span> num2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> strategy<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Client</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StrategyTest</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">doStrategy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-2-模板方法（Templete-Method）模式"><a href="#3-2-模板方法（Templete-Method）模式" class="headerlink" title="3.2 模板方法（Templete Method）模式"></a>3.2 模板方法（Templete Method）模式</h2><h2 id="3-3-观察者（Observer）模式"><a href="#3-3-观察者（Observer）模式" class="headerlink" title="3.3 观察者（Observer）模式"></a>3.3 观察者（Observer）模式</h2><h2 id="3-4-迭代子（Iterator）模式"><a href="#3-4-迭代子（Iterator）模式" class="headerlink" title="3.4 迭代子（Iterator）模式"></a>3.4 迭代子（Iterator）模式</h2><h2 id="3-5-责任链（Chain-of-Responsibility）模式"><a href="#3-5-责任链（Chain-of-Responsibility）模式" class="headerlink" title="3.5 责任链（Chain of Responsibility）模式"></a>3.5 责任链（Chain of Responsibility）模式</h2><h2 id="3-6-命令（Command）模式"><a href="#3-6-命令（Command）模式" class="headerlink" title="3.6 命令（Command）模式"></a>3.6 命令（Command）模式</h2><h2 id="3-7备忘录（Memento）模式"><a href="#3-7备忘录（Memento）模式" class="headerlink" title="3.7备忘录（Memento）模式"></a>3.7备忘录（Memento）模式</h2><h2 id="5-8-状态（State）模式"><a href="#5-8-状态（State）模式" class="headerlink" title="5.8 状态（State）模式"></a>5.8 状态（State）模式</h2><h3 id="5-8-1-说明"><a href="#5-8-1-说明" class="headerlink" title="5.8.1 说明"></a>5.8.1 说明</h3><p><strong>意图：</strong>允许对象在内部状态发生改变时改变它的行为，对象看起来好像修改了它的类。</p>
<p><strong>主要解决：</strong>对象的行为依赖于它的状态（属性），并且可以根据它的状态改变而改变它的相关行为。</p>
<p><strong>何时使用：</strong>代码中包含大量与对象状态有关的条件语句。</p>
<p><strong>如何解决：</strong>将各种具体的状态类抽象出来。</p>
<p><strong>关键代码：</strong>通常命令模式的接口中只有一个方法。而状态模式的接口中有一个或者多个方法。而且，状态模式的实现类的方法，一般返回值，或者是改变实例变量的值。也就是说，状态模式一般和对象的状态有关。实现类的方法有不同的功能，覆盖接口中的方法。状态模式和命令模式一样，也可以用于消除 if…else 等条件选择语句。</p>
<p><strong>应用实例：</strong> 1、打篮球的时候运动员可以有正常状态、不正常状态和超常状态。 2、曾侯乙编钟中，’钟是抽象接口’,’钟A’等是具体状态，’曾侯乙编钟’是具体环境（Context）。</p>
<p><strong>优点：</strong> 1、封装了转换规则。 2、枚举可能的状态，在枚举状态之前需要确定状态种类。 3、将所有与某个状态有关的行为放到一个类中，并且可以方便地增加新的状态，只需要改变对象状态即可改变对象的行为。 4、允许状态转换逻辑与状态对象合成一体，而不是某一个巨大的条件语句块。 5、可以让多个环境对象共享一个状态对象，从而减少系统中对象的个数。</p>
<p><strong>缺点：</strong> 1、状态模式的使用必然会增加系统类和对象的个数。 2、状态模式的结构与实现都较为复杂，如果使用不当将导致程序结构和代码的混乱。 3、状态模式对”开闭原则”的支持并不太好，对于可以切换状态的状态模式，增加新的状态类需要修改那些负责状态转换的源代码，否则无法切换到新增状态，而且修改某个状态类的行为也需修改对应类的源代码。</p>
<p><strong>使用场景：</strong> 1、行为随状态改变而改变的场景。 2、条件、分支语句的代替者。</p>
<p><strong>注意事项：</strong>在行为受状态约束的时候使用状态模式，而且状态不超过 5 个。</p>
<h3 id="5-8-2-类图"><a href="#5-8-2-类图" class="headerlink" title="5.8.2 类图"></a>5.8.2 类图</h3><pre class="mermaid">classDiagram

class State {
  <<interface>>
  +doAction()
}

class StartState {
    +doAction()
}

class StopState {
    +doAction()
}

class Context {
    -state: State
    +Context()
    +getState(): State
    +setState(State state)
}

State <.. StartState
State <.. StopState
State --o Context</pre>

<p>就是</p>
<h2 id="5-9-访问者（Visitor）模式"><a href="#5-9-访问者（Visitor）模式" class="headerlink" title="5.9 访问者（Visitor）模式"></a>5.9 访问者（Visitor）模式</h2><h2 id="5-10-中介者-调停者（Mediator）模式"><a href="#5-10-中介者-调停者（Mediator）模式" class="headerlink" title="5.10 中介者/调停者（Mediator）模式"></a>5.10 中介者/调停者（Mediator）模式</h2><h2 id="5-11-解释器（Interpreter）模式"><a href="#5-11-解释器（Interpreter）模式" class="headerlink" title="5.11 解释器（Interpreter）模式"></a>5.11 解释器（Interpreter）模式</h2><h1 id="一-UML相关知识"><a href="#一-UML相关知识" class="headerlink" title="一 UML相关知识"></a>一 UML相关知识</h1><h2 id="1-1-实体"><a href="#1-1-实体" class="headerlink" title="1.1 实体"></a>1.1 实体</h2><h3 id="1-1-1-类，抽象类"><a href="#1-1-1-类，抽象类" class="headerlink" title="1.1.1 类，抽象类"></a>1.1.1 类，抽象类</h3><p>![Untitled](/Users/liyunhan/Desktop/Export-ceba61ce-4255-4080-bf09-6b46d0cd0d84/设计模式 8c5668a8c6b746559d40a20773eb75da/Untitled 1.png)</p>
<p>包括类，抽象类（斜体）</p>
<ol>
<li><p>第一行：实体名</p>
</li>
<li><p>第二行：属性</p>
<p>+：public</p>
<p>-：private</p>
<p>#：protected</p>
</li>
<li><p>第三行：方法</p>
</li>
</ol>
<h3 id="1-1-2-接口"><a href="#1-1-2-接口" class="headerlink" title="1.1.2 接口"></a>1.1.2 接口</h3><p><img src="https://gitee.com/liyunh/image/raw/master/master/202110060739164.png" alt="Untitled"></p>
<h2 id="1-2-关系"><a href="#1-2-关系" class="headerlink" title="1.2 关系"></a>1.2 关系</h2><p>![Untitled](/Users/liyunhan/Desktop/Export-ceba61ce-4255-4080-bf09-6b46d0cd0d84/设计模式 8c5668a8c6b746559d40a20773eb75da/Untitled 3.png)</p>
<h3 id="1-2-1-继承"><a href="#1-2-1-继承" class="headerlink" title="1.2.1 继承"></a>1.2.1 继承</h3><p>![Untitled](/Users/liyunhan/Desktop/Export-ceba61ce-4255-4080-bf09-6b46d0cd0d84/设计模式 8c5668a8c6b746559d40a20773eb75da/Untitled 4.png)</p>
<p>A继承B，A指向B，使用空心三角加直线表示。</p>
<h3 id="1-2-2-关联"><a href="#1-2-2-关联" class="headerlink" title="1.2.2 关联"></a>1.2.2 关联</h3><p>关联是一种“拥有”关系，指一个类需要“知道”另一类的属性或方法。在代码中的表现为在类A的定义中使用类B作为成员变量。</p>
<p>![Untitled](/Users/liyunhan/Desktop/Export-ceba61ce-4255-4080-bf09-6b46d0cd0d84/设计模式 8c5668a8c6b746559d40a20773eb75da/Untitled 5.png)</p>
<h3 id="1-2-3-聚合"><a href="#1-2-3-聚合" class="headerlink" title="1.2.3 聚合"></a>1.2.3 聚合</h3><p>聚合属于关联中“弱”的拥有关系，体现的是A可以包含B，但B不是A的一部分，两者的生命周期不同。如企鹅和企鹅群，企鹅组成了企鹅群，企鹅离开企鹅群可以单独存在。其结构图如下：</p>
<p><img src="https://gitee.com/liyunh/image/raw/master/master/202110060739430.png" alt="Untitled"></p>
<h3 id="1-2-4-组合"><a href="#1-2-4-组合" class="headerlink" title="1.2.4 组合"></a>1.2.4 组合</h3><p>组合属于关联中“强”的拥有关系，体现的是A包含B，B是A的一部分，两者有相同的生命周期。如企鹅和眼睛、鼻子等。</p>
<p>![Untitled](/Users/liyunhan/Desktop/Export-ceba61ce-4255-4080-bf09-6b46d0cd0d84/设计模式 8c5668a8c6b746559d40a20773eb75da/Untitled 7.png)</p>
<p>聚合和组合的区别在于整体与部分的生命周期不同，这在代码中也有所体现。在上述例子中，聚合关系中企鹅群类中引用企鹅类作为参数，并没有实例化Penguin，这就是说当Penguins类撤销时，penguin类存在并可能作为参数引用其他类当中。 组合关系中在Penguin类初始化的同时，创建Eyes和Nose对象，当Penguin类撤销时，Eyes和Nose类同时撤销，表现为三者的生命周期相同。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/post/2.Computer%20Basics/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" data-id="ckujn7ln90002a53nam3fdvey" data-title="设计模式" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/post/test.html">test</a>
          </li>
        
          <li>
            <a href="/post/1.Personal/%E7%AC%94%E8%AE%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA.html">(no title)</a>
          </li>
        
          <li>
            <a href="/post/hello-world.html">Hello World</a>
          </li>
        
          <li>
            <a href="/post/5.Java/Mybatis.html">Mybatis</a>
          </li>
        
          <li>
            <a href="/post/10.Body/%E8%BF%90%E5%8A%A8%E8%A7%A3%E5%89%96%E5%AD%A6.html">运动解剖学</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>